
<!-- saved from url=(0086)https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84601 -->
<html lang="pt-BR" data-product="alura_espanhol" style="scroll-behavior: smooth;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" type="text/css" href="./loqueHicimos_files/clipper.647d33f8.css">
<link rel="stylesheet" href="./loqueHicimos_files/back-to-top.9a8b5967.css">
<link rel="stylesheet" href="./loqueHicimos_files/videoShortcutsModal.e1c7fc31.css">
<link rel="stylesheet" href="./loqueHicimos_files/modal.5da2b30a.css">
<link rel="stylesheet" href="./loqueHicimos_files/modalCoursePreviewMode.fe9f769f.css">

























	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	

	

	
		




    
        
        
            <!-- Google Tag Manager -->
            <script type="text/javascript" async="" src="./loqueHicimos_files/js"></script><script type="text/javascript" async="" src="./loqueHicimos_files/js(1)"></script><script async="" src="./loqueHicimos_files/analytics.js.descarga"></script><script async="" src="./loqueHicimos_files/gtm.js.descarga"></script><script>
                ;(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayerAlura','GTM-PFCN2KV');
            </script>
            <!-- End Google Tag Manager -->
        
    


    <script>
        let dataLayerAluraTest = window.dataLayerAluraTest || [];
        let dataLayerAlura = window.dataLayerAlura || [];
        dataLayerAlura.push({
            'event': 'virtual_page_view',
            'page_category': 'Aula',
            
            
            
                
                    
                    
                        
                        'user_id': '576082',
                        'plan': 'Oracle Next Education F2 T5',
                        'type': 'B2B',
                        'company_id':'5013',
                        'first_purchase_date': '2023-03-28',
                        'last_purchase_date': '2023-03-28',
                        'expiration_date': '2023-10-04',
                        'email': 'b7a5de8d38d6e9c501dc677df972f9557de039ce9e8dc8976e0d6c048a508798'
                    
                
            
        });
    </script>





	

	<title>Spring Boot 3: documentar, probar y preparar una API para su implementación: Aula 1 - Actividad 13 Haga lo que hicimos en aula | Alura Latam - Cursos online de tecnologia</title>
	
	<link rel="shortcut icon" href="https://app.aluracursos.com/assets/images/aluraespanhol/favicon.ico">
	
	<link href="./loqueHicimos_files/css" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.gstatic.com/">

	<link rel="stylesheet" href="./loqueHicimos_files/video-js.7b9aee00.css">
	<link rel="stylesheet" href="./loqueHicimos_files/silvermine-videojs-quality-selector.min.de928d55.css">
	<link rel="stylesheet" href="./loqueHicimos_files/prettify.9c184279.css">
	<link rel="stylesheet" href="./loqueHicimos_files/github.754087c4.css">

	<link rel="stylesheet" href="./loqueHicimos_files/base.f643e441.css">
	<link rel="stylesheet" href="./loqueHicimos_files/formattedText.e58775de.css">
	
	<link rel="stylesheet" href="./loqueHicimos_files/container.ca700c42.css">
	<link rel="stylesheet" href="./loqueHicimos_files/classPage.ee5a0101.css">
	<link rel="stylesheet" href="./loqueHicimos_files/menuSettings.825e8801.css">
	<link rel="stylesheet" href="./loqueHicimos_files/taskProgress.a5300583.css">
	<link rel="stylesheet" href="./loqueHicimos_files/taskMessageInfo.67eb9bc6.css">
	<link rel="stylesheet" href="./loqueHicimos_files/alternativeList.a80939d3.css">
	<link rel="stylesheet" href="./loqueHicimos_files/taskFeedback.4bda0782.css">
	<link rel="stylesheet" href="./loqueHicimos_files/markdown.3ec31c65.css">
	<link rel="stylesheet" href="./loqueHicimos_files/finishSection.bee005cf.css">
	<link rel="stylesheet" href="./loqueHicimos_files/phrase.6d459a32.css">
	<link rel="stylesheet" href="./loqueHicimos_files/hqexplanation.3ed41021.css">
	<link rel="stylesheet" href="./loqueHicimos_files/openquestion.2889f14f.css">
	<link rel="stylesheet" href="./loqueHicimos_files/textcontent.7298b79f.css">
	<link rel="stylesheet" href="./loqueHicimos_files/video.e82ab0eb.css">
	<link rel="stylesheet" href="./loqueHicimos_files/singlechoice.b545e19f.css">
	<link rel="stylesheet" href="./loqueHicimos_files/music.8fe6cab6.css">
	<link rel="stylesheet" href="./loqueHicimos_files/multiplechoice.70f60e4c.css">
	<link rel="stylesheet" href="./loqueHicimos_files/videodialog.36286910.css">
	<link rel="stylesheet" href="./loqueHicimos_files/fillintheblank.59273039.css">
	<link rel="stylesheet" href="./loqueHicimos_files/speakingpractice.13b2c5c5.css">
	<link rel="stylesheet" href="./loqueHicimos_files/pronunciationpractice.d512f574.css">
	<link rel="stylesheet" href="./loqueHicimos_files/repetition.492af846.css">
	<link rel="stylesheet" href="./loqueHicimos_files/genericVideo.4767d8de.css">
	<link rel="stylesheet" href="./loqueHicimos_files/projectSubmit.ce2f9d80.css">
	<link rel="stylesheet" href="./loqueHicimos_files/sortBlocks.7b9eb1fc.css">
	<link rel="stylesheet" href="./loqueHicimos_files/extraContentTask.b2d126e6.css">
	<link rel="stylesheet" href="./loqueHicimos_files/taskContent.1ef47209.css">
	<link rel="stylesheet" href="./loqueHicimos_files/taskButtons.ed4fd65b.css">
	<link rel="stylesheet" href="./loqueHicimos_files/alert.ec6bb786.css">
	<link rel="stylesheet" href="./loqueHicimos_files/markdownEditor.600de57a.css">
	<link rel="stylesheet" href="./loqueHicimos_files/audioPlayer.0a362c88.css">
	<link rel="stylesheet" href="./loqueHicimos_files/notes.867f62ab.css">
	
	
	
	<link rel="stylesheet" href="./loqueHicimos_files/successMessage.cb6c074e.css">

	<link rel="stylesheet" href="./loqueHicimos_files/dark-mode.0598a04f.css">
	<link rel="stylesheet" href="./loqueHicimos_files/taskFeedbackAnswer.72669c00.css">
	<link rel="stylesheet" href="./loqueHicimos_files/theater-mode.91e2f524.css">
	<link rel="stylesheet" href="./loqueHicimos_files/autoplay-videojs.eefac430.css">
	<link rel="stylesheet" href="./loqueHicimos_files/linkSubmit.ddbc8743.css">

	
	
	<style type="text/css">
		.task:before, .video-js .vjs-play-progress {
			background-color: #2A7AE4;
		}


	</style>

	<!-- Remove cookie banner from hubspot -->
	<style>
		div#hs-eu-cookie-confirmation {
			display: none;
		}
	</style>

	<meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"></head>




<body class="darkmode ">
<script src="./loqueHicimos_files/avatarOnError.f8bd8956.js.descarga"></script>




	


<!-- Google Tag Manager (noscript) -->
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PFCN2KV"
				  height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



<section class="task  
 menu--inactive" data-allow-answer="true" data-task-section-exam="false" data-task-type="textcontent" data-task-id="84601" data-author-id="576082" data-course-code="spring-boot-3-api-para-su-implementacion" data-section-name="Agendamiento de consultas" data-section-id="11458" data-section-number="1" data-domain="app.aluracursos.com" data-hasfeedbackanswer="false" data-url-prefix="/" data-already-seen-task="true" data-course-name="Spring Boot 3: documentar, probar y preparar una API para su implementación" data-category-name="Programación" data-subcategory-name="Java" data-workload="12" data-teachers="jose viera">

	<section class="task-body">
		
		











<header class="task-body-header">
    













    <div class="container">

        
            
            <button title="" aria-label="" type="button" class="theatermode openMenu-button task-menu-button
                    " id="menu-button-header">
            </button>
        

        <h1 class="task-body-header-title">
            
            
            <svg class="task-body-header-title-svg" aria-label="Actividad de Sin respuesta del estudiante">
                <use xlink:href="/assets/images/classPage/icon-menu-icons.svg#DO_AFTER_ME"></use>
            </svg>
            <small>13</small>
            <span class="task-body-header-title-text"> Haga lo que hicimos en aula</span>
        </h1>
        
            <div class="task-body-header-actions">
                <a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84601/next" aria-hidden="true" class="task-actions-button task-actions-button-next task-submit bootcamp-primary-button-theme" style="background-color: #2A7AE4">Próxima Actividad</a>
            </div>
        


        
            







<div class="theater-video settings">
	<button type="button" class="settings-button" aria-label="Configuraciones">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo nocturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://app.aluracursos.com/suggestions/new/spring-boot-3-api-para-su-implementacion/84601/question">Sugerir alteración</a></li>
					
				
			
			
		</ul>
		<span class="settings-box-title"></span>
	</div>
</div>

        
    </div>
</header>
		<div class="task-body__wrapper">
			



<section class="class-notes">
    <div class="class-notes-content">
        <h2 class="class-notes-title">Mi cuaderno del curso (beta)</h2>
        <p class="class-notes-description">Este es su cuaderno de anotaciones aquí en Alura Latam. Todo su contenido es visible apenas para tí.<a href="https://suporte.alura.com.br/article/308-meu-caderno-como-funciona" class="class-notes-faq-link">FAQ</a></p>
        <textarea name="text" id="courseNotebook-text" class="class-notes-text" cols="30" rows="10" maxlength="60000"></textarea>
        <div class="class-notes-save-wrapper">
            <span>
                <p class="class-notes-saved-text" aria-hidden="true" style="display: none">Notas guardadas</p>
                <p class="class-notes-limit-text" aria-hidden="true" style="display: none">¡No se pudo guardar! ¡Límite de caracteres alcanzado ({max})!</p>
            </span>
            <span class="class-notes-save-button-wrapper">
                <button class="class-notes-save-button" data-save-text="Guardar cuaderno" data-saving-text="Guardandando">
                   Guardar cuaderno</button>
            </span>
        </div>
        <button class="class-notes-close-button"></button>
    </div>
</section>
			<main class="task-body-main container" data-should-warn="false">
				







	
	
	
		





<section id="task-content" class="textContent">
	
	<div class="container">
		







<div class="video settings">
	<button type="button" class="settings-button" aria-label="Configuraciones">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo nocturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://app.aluracursos.com/suggestions/new/spring-boot-3-api-para-su-implementacion/84601/question">Sugerir alteración</a></li>
					
				
			
			
		</ul>
		<span class="settings-box-title"></span>
	</div>
</div>

		<div class="formattedText" data-external-links="">
			<p>Ha llegado el momento de que sigas todos los pasos que he dado durante esta lección. En caso de que ya lo hayas hecho, excelente. Si aún no lo ha hecho, es importante que realice lo que se vio en los videos para que pueda continuar con la siguiente lección.</p>
<hr>
<p>¡Vamos a empezar el proyecto! En la columna "DONE" en Trello, podemos ver que ya hemos implementado las funcionalidades de CRUD para médicos y pacientes. En la columna "TO DO" a la izquierda, faltan las funcionalidades de programación y cancelación de citas.</p>
<p>Comenzaremos implementando la programación. Por lo tanto, moveremos la tarjeta "Agendamiento de consultas" a la columna "DOING". Con un clic en la tarjeta, abriremos su información y, como de costumbre, leeremos la descripción de la funcionalidad para entender lo que necesitamos hacer.</p>
<p>La descripción dice lo siguiente:</p>
<p>"El sistema debe tener una funcionalidad que permita la programación de citas, en la que se deben completar la siguiente información: Paciente, Médico, Fecha/Hora de la consulta".</p>
<p>"Se deben validar las siguientes reglas de negocio por parte del sistema: (sigue una lista con reglas de negocio)".</p>
<p>Esta es una funcionalidad similar a las que ya hemos implementado. Nuestra API recibirá una solicitud con el ID del paciente o del médico y la fecha en que se realizará la consulta.</p>
<p>Con esta información, realizaremos las validaciones y las guardaremos en la base de datos. La diferencia es que ahora tenemos reglas de negocio más complejas que las que hemos visto anteriormente para médicos y pacientes.</p>
<p>Abrimos nuestro diseño de Figma con un modelo de aplicación móvil para nuestro proyecto.</p>
<p><img src="./loqueHicimos_files/image1.jpg" alt=""></p>
<p>En la aplicacion móvil, la persona tendrá una pantalla para agendar una nueva consulta, que contiene el nombre del paciente y del médico o médica. Estas informaciones serán extraídas de nuestra base de datos. Además, habrá dos campos para la elección del día y de la hora de la consulta, así como un botón para confirmar la programación.</p>
<p>Por lo tanto, la aplicación móvil necesita hacer validaciones de los campos obligatorios, siendo opcional solamente el campo "Nombre del médico". Cuando la persona complete todos los campos obligatorios y haga clic en "Agendar consulta", se disparará una solicitud a nuestra API. Necesitaremos recibir estos datos y tratarlos como ya hemos hecho en las otras funcionalidades.</p>
<p>Volviendo a la tarjeta en Trello, la única diferencia son algunas de las validaciones, que requerirán la escritura de un algoritmo, consulta en la base de datos, etc.</p>
<p>Así, estas no son sólo validaciones de formulario como aquellas con las que trabajamos anteriormente con BEAN validation (campo obligatorio, campo número o texto, tamaño mínimo y máximo, etc.). Ahora, tendremos que aprender a trabajar con validaciones un poco más complejas.</p>
<p>Códigos para nuevas funcionalidades</p>
<p>Para implementar esta o cualesquiera otras funcionalidades, seguimos una especie de paso a paso. Necesitamos crear siempre los siguientes tipos de códigos:</p>
<ul><li>Controller, para mapear la solicitud de la nueva funcionalidad;</li><li>DTOs, que representan los datos que llegan y salen de la API;</li><li>Entidad JPA;</li><li>Repository, para aislar el acceso a la base de datos;</li><li>Migration, para hacer las alteraciones en la base de datos.</li></ul>
<p>Estos son los cinco tipos de código que siempre desarrollaremos para una nueva funcionalidad. Esto también se aplica al agendamiento de las consultas, incluyendo un sexto elemento a la lista, las reglas de negocio. En esta clase, entenderemos cómo implementar las reglas de negocio con algoritmos más complejos.</p>
<p>Implementando la funcionalidad</p>
<p>Ahora que ya entendemos lo que necesita ser hecho, desarrollaremos la funcionalidad por partes. Empezaremos por los primeros cinco elementos de la lista, que son más básicos. Luego, abordaremos la parte de reglas de negocio.</p>
<p>Abriré el IntelliJ con el proyecto importado en la IDE. Es el mismo proyecto del curso anterior, que finalizamos con la parte de seguridad y tratamiento de errores.</p>
<p>Como la primera parte seguirá un mismo patrón, dejé esas clases listas en el código. Creé un nuevo ConsultaController en el paquete "src &gt; main &gt; java &gt; med.voll.api &gt; controller".</p>
<p>Ya que no estaremos más registrando pacientes, sino consultas, la idea es tener un Controller para recibir esas solicitudes relacionadas con la programación de consultas.</p>
<p>Es una clase Controller, con las anotaciones del Spring: @Controller,@ResponseBody, @RequestMapping("consultas") o @RestController. Mapea las solicitudes que llegan con la URI "/consultas", sabiendo que debe llamar a este controller y no a los otros.</p>
<p>Luego, tenemos un método anotado con @PostMapping. Entonces, la solicitud para programar una consulta será del tipo Post, como observamos en las otras funcionalidades.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-variable">@Controller</span>
<span class="hljs-variable">@ResponseBody</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/consultas"</span>)
public class ConsultaController {

   <span class="hljs-variable">@PostMapping</span>
   <span class="hljs-variable">@Transactional</span>   
   public ResponseEntity <span class="hljs-built_in">agendar</span>(<span class="hljs-variable">@RequestBody</span> <span class="hljs-variable">@Valid</span> DatosAgendarConsulta datos) {

<span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(dados);
           <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(new <span class="hljs-built_in">DatosDetalleConsulta</span>(null, null, null, null));

   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Al abrir DatosAgendarConsulta, notaremos que se trata de un registro similar a los que vimos anteriormente. Tiene los campos que provienen de la API (Long idMedico, Long idPaciente y LocalDateTime fecha) y las anotaciones de BEAN validation @NotNull para el ID de la persona paciente y para la fecha, además de que la fecha debe ser en el futuro (@Future), es decir, no podemos programar una consulta para días que ya han pasado.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">record</span> <span class="hljs-selector-tag">DatosAgendarConsulta</span>(

       <span class="hljs-variable">@NotNull</span>
       Long idPaciente,
       Long idMedico,
       <span class="hljs-variable">@NotNull</span>
       <span class="hljs-variable">@Future</span>
       LocalDateTime fecha,
       Especialidad especialidad) {

}</code><button type="button" class="clipit">Copia el código</button></pre><p>Al volver al Controller, nuestro otro DTO es el de respuesta, llamado DatosDetalleConsulta. Devuelve el ID de la consulta creada, del médico, del paciente y la fecha de la consulta registrada en el sistema.</p>
<p>Además, en el paquete "src &gt; main &gt; java &gt; med.voll.api &gt; domain", creamos el subpaquete "consulta", que abarca las clases relacionadas con el dominio de consulta.</p>
<p>Entre ellas, tenemos la entidad JPA "Consulta.java", que contiene las anotaciones de JPA y Lombok, así como la información de la consulta: médico, paciente y fecha.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-variable">@Table</span>(name = <span class="hljs-string">"consultas"</span>)
<span class="hljs-variable">@Entity</span>(name = <span class="hljs-string">"Consulta"</span>)
<span class="hljs-variable">@Getter</span>
<span class="hljs-variable">@NoArgsConstructor</span>
<span class="hljs-variable">@AllArgsConstructor</span>
<span class="hljs-variable">@EqualsAndHashCode</span>(of = <span class="hljs-string">"id"</span>)
public class Consulta {

   <span class="hljs-variable">@Id</span>
   <span class="hljs-variable">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)
   private Long id;

   <span class="hljs-variable">@ManyToOne</span>(fetch = FetchType.LAZY)
   <span class="hljs-variable">@JoinColumn</span>(name = <span class="hljs-string">"medico_id"</span>)
   private Medico medico;

   <span class="hljs-variable">@ManyToOne</span>(fetch = FetchType.LAZY)
   <span class="hljs-variable">@JoinColumn</span>(name = <span class="hljs-string">"paciente_id"</span>)
   private Paciente paciente;

   <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">LocalDateTime</span> <span class="hljs-selector-tag">fecha</span>;

}
</code><button type="button" class="clipit">Copia el código</button></pre><p>En este caso, médico y paciente son relaciones con las otras entidades Medico y Paciente.</p>
<p>También creamos  "ConsultaRepository.java", que está vacío por el momento.</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-meta">@Repository</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ConsultaRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;Consulta, Long&gt; {

}</code><button type="button" class="clipit">Copia el código</button></pre><p>Por último, tenemos la migración en "src &gt; main &gt; java &gt; med.voll.api &gt; resources", en la carpeta "db.migration". Teníamos cinco migraciones, pero ahora creé la migración número 6 ("V6"), que crea la tabla de consultas.</p>
<pre class="prettyprint"><code class="hljs language-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> consultas(

   id <span class="hljs-type">bigint</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> auto_increment,
   medico_id <span class="hljs-type">bigint</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
   paciente_id <span class="hljs-type">bigint</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
   fecha datetime <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,

   <span class="hljs-keyword">primary</span> key(id),

   <span class="hljs-keyword">constraint</span> fk_consultas_medico_id <span class="hljs-keyword">foreign</span> key(medico_id) <span class="hljs-keyword">references</span> medicos(id),
   <span class="hljs-keyword">constraint</span> fk_consultas_paciente_id <span class="hljs-keyword">foreign</span> key(paciente_id) <span class="hljs-keyword">references</span> pacientes(id)

);</code><button type="button" class="clipit">Copia el código</button></pre><p>los campos de ID de consulta, ID de paciente, ID de médico y fecha, donde medico_id y paciente_id son claves foráneas que apuntan a las tablas de médicos y pacientes.</p>
<p>Estos son los códigos estándar para cualquier funcionalidad, con sus respectivos cambios de acuerdo con el proyecto. Cada uno creará un controlador o una entidad distinta, pero el funcionamiento es el mismo.</p>
<p>El proyecto se inició sin errores. Ahora podemos intentar enviar una solicitud a la dirección "/consultas" y verificar si se redirige al "ConsultaController.java" y nos muestra el System.out que muestra los datos que llegaron en el JSON de la solicitud.</p>
<p>Para enviar la solicitud, continuaremos utilizando Postman.</p>
<pre class="prettyprint"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
<span class="hljs-attr">"idPaciente"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"idMedico"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"fecha"</span><span class="hljs-punctuation">:</span> 
<span class="hljs-punctuation">}</span></code><button type="button" class="clipit">Copia el código</button></pre><p>el atributo "fecha" está representado por LocalDateTime, la clase de fechas que se introdujo en Java 8. ¿Cómo enviamos una fecha en la solicitud JSON de manera que Spring pueda crear correctamente el objeto LocalDateTime? ¿Qué formato usamos para la fecha?</p>
<p>Es necesario que la fecha esté entre comillas, como si fuera una cadena, y tenga el formato de fecha americano: AAAA-MM-DD. Para separar la fecha de la hora, escribimos la letra "T" en mayúscula y la hora en formato HH:MM:SS. Los segundos son opcionales.</p>
<p>Así que la solicitud se verá de la siguiente manera:</p>
<pre class="prettyprint"><code class="hljs language-json"><span class="hljs-punctuation">{</span>
<span class="hljs-attr">"idPaciente"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"idMedico"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"fecha"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-10-10T10:00"</span>
<span class="hljs-punctuation">}</span></code><button type="button" class="clipit">Copia el código</button></pre><p>Ya hemos implementado el esqueleto de la funcionalidad. Ahora necesitamos implementar las reglas de negocio.</p>
<p>Nuestro trabajo será un poco diferente a lo que ya hicimos con la validación de campos de formulario vía BEAN validation. Ahora, las validaciones son más complejas. ¿Pero cómo las implementamos?</p>
<p>Volviendo a IntelliJ y observando "ConsultaController.java", podríamos hacer todas las validaciones en el método agendar(), antes del retorno. Sin embargo, esa no es una buena práctica.</p>
<p>La clase controller no debe traer las reglas de negocio de la aplicación.</p>
<p>Es solo una clase que controla el flujo de ejecución: cuando llega una solicitud, llama a la clase X, devuelve la respuesta Y. Si la condición es Z, devuelve otra respuesta y así sucesivamente. Es decir, solo controla el flujo de ejecución y, por lo tanto, no debería tener reglas de negocio.</p>
<p>Así, aislando las reglas de negocio, los algoritmos, los cálculos y las validaciones en otra clase que será llamada por el Controller.</p>
<p>Expandiremos el menú "Project" en el lado izquierdo de la interfaz, seleccionaremos el paquete "consulta" . De esta manera, crearemos una clase para contener las reglas de agendamiento de consultas. La llamaremos "AgendaDeConsultasService".</p>
<p>El nombre es muy autoexplicativo: esta clase contendrá la agenda de consultas. Podemos tener en esta clase otras funcionalidades aún relacionadas con el agendamiento de consultas.</p>
<p>Como acabamos de crear la clase y aún no tiene ninguna anotación, el Spring Boot no puede cargarla automáticamente. Por lo tanto, necesitamos insertar alguna anotación primero.</p>
<p>Sin embargo, esta no es una clase Controller ni una clase de configuraciones. Esta clase representa un servicio de la aplicación, el de agendamiento de consultas. Por lo tanto, será una clase de servicios (Service) y llevará la anotación @Service. El objetivo de esta anotación es declarar el componente de servicio al Spring Boot.</p>
<p>Dentro de esta clase, crearemos un método public void agendar(), que recibe como parámetro el DTO DatosAgendarConsulta.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgendaDeConsultaService</span> {
   <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">agendar</span>(<span class="hljs-params">DatosAgendarConsulta datos</span>){


   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>La clase Service ejecuta las reglas de negocio y las validaciones de la aplicación.</p>
<p>Necesitaremos utilizar esta clase en "ConsultaController.java". Necesitamos declarar un atributo del tipo AgendaDeConsultas, llamándolo agenda. Para pedirle a Spring que instancie este objeto, usaremos @Autowired encima del atributo.</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> AgendaDeConsultaService service;</code><button type="button" class="clipit">Copia el código</button></pre><p>Con esto, hemos inyectado la clase AgendaDeConsultas en el Controller. En el método agendar del Controller, obtendremos el objeto agenda y llamaremos al método agendar(), pasando como parámetro los datos que llegan al Controller. Todo esto antes del retorno.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-variable">@PostMapping</span>
   <span class="hljs-variable">@Transactional</span>   
   public ResponseEntity <span class="hljs-built_in">agendar</span>(<span class="hljs-variable">@RequestBody</span> <span class="hljs-variable">@Valid</span> DatosAgendarConsulta datos) {

<span class="hljs-selector-tag">service</span><span class="hljs-selector-class">.agendar</span>(datos);
<span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(new <span class="hljs-built_in">DatosDetalleConsulta</span>(null, null, null, null));

   }</code><button type="button" class="clipit">Copia el código</button></pre><p>El Controller recibe la información, hace solo la validación de BIN validation y llama a la clase Service AgendaDeConsultas, que ejecutará las reglas de negocio. Esta es la forma correcta de manejar las reglas de negocio.</p>
<p>Ahora abriremos la clase AgendaDeConsultas y escribiremos todas las validaciones que figuran en el cartão do Trello dentro del método agendar().</p>
<p>Al final del día, nuestro objetivo es guardar el agendamiento en la base de datos: recibimos la solicitud con los datos de agendamiento y necesitamos guardarlos en la tabla de consultas.</p>
<p>Por lo tanto, necesitamos acceder a la base de datos y a la tabla de consultas en esta clase. Así que declararemos un atributo ConsultaRepository, llamándolo consultaRepository.</p>
<p>Justo encima del atributo, usaremos la anotación @Autowired para que el Spring Boot inyecte este repository en nuestra clase Service.</p>
<p>Al final del método agendar(), insertaremos consultaRepository.save() y pasaremos un objeto del tipo consulta, la entidad JPA. Obviamente, solo podemos llamar a este método si todas las validaciones se han ejecutado de acuerdo con las reglas de negocio.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgendaDeConsultaService</span> {

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">ConsultaRepository</span> consultaRepository;

   <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">agendar</span>(<span class="hljs-params">DatosAgendarConsulta datos</span>){

    consultaRepository.<span class="hljs-title function_">save</span>(consulta);

   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Ya hemos llamado  "save", pero está dando un error de compilación porque la variable "consulta" aún no ha sido creada. Por lo tanto, necesitamos ejecutar esta acción.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgendaDeConsultaService</span> {

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">ConsultaRepository</span> consultaRepository;

   <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">agendar</span>(<span class="hljs-params">DatosAgendarConsulta datos</span>){

    <span class="hljs-keyword">var</span> consulta = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Consulta</span>();
consultaRepository.<span class="hljs-title function_">save</span>(consulta);

   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>La entidad Consulta está anotada con @AllArgsConstructor de Lombok, que genera un constructor con todos los atributos. Podemos usar este mismo constructor en "AgendamientoDeConsultas". El primer parámetro es el ID null, ya que es la base de datos la que pasará el ID. El segundo es médico, paciente y fecha. Esta última vendrá en el DTO, a través del parámetro datos.</p>
<p>Sucede que el médico y el paciente no llegan en la solicitud, sino el ID del médico y el ID del paciente. Por lo tanto, necesitamos establecer el objeto completo en la entidad y no solo el ID.</p>
<p>Por lo tanto, necesitamos cargar médico y paciente desde la base de datos. Necesitaremos inyectar, entonces, dos Repositories más en nuestro Service: MedicoRepository y PacienteRepository.</p>
<p>En el método agendar(), necesitamos crear un objeto paciente también. Usaremos pacienteRepository.findById() para buscar el objeto por ID, que está dentro del DTO datos.</p>
<p>En la solicitud solo viene el ID, pero necesitamos cargar el objeto completo. Por lo tanto, usamos el Repository para cargar por el ID de la base de datos. El médico seguirá la misma dinámica.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgendaDeConsultaService</span> {

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">PacienteRepository</span> pacienteRepository;
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">MedicoRepository</span> medicoRepository;
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-title class_">ConsultaRepository</span> consultaRepository;

   <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">agendar</span>(<span class="hljs-params">DatosAgendarConsulta datos</span>){
<span class="hljs-keyword">var</span> paciente = pacienteRepository.<span class="hljs-title function_">findById</span>(datos.<span class="hljs-title function_">idPaciente</span>()).;

<span class="hljs-keyword">var</span> medico = medicoRepository.<span class="hljs-title function_">findById</span>(datos.<span class="hljs-title function_">idMedico</span>()).;

    <span class="hljs-keyword">var</span> consulta = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Consulta</span>(<span class="hljs-literal">null</span>,medico,paciente,datos.<span class="hljs-title function_">fecha</span>());
consultaRepository.<span class="hljs-title function_">save</span>(consulta);

   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Aparecerá un error de compilación porque el método findById() no devuelve la entidad, sino un Optional. Por lo tanto, al final de la línea, antes del punto y coma, necesitamos escribir .get() junto a findById(). Esto hace que tome la entidad cargada.</p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> paciente = pacienteRepository.findById(datos.idPaciente()).<span class="hljs-keyword">get</span>();

<span class="hljs-keyword">var</span> medico = medicoRepository.findById(datos.idMedico()).<span class="hljs-keyword">get</span>();

    <span class="hljs-keyword">var</span> consulta = <span class="hljs-keyword">new</span> Consulta(<span class="hljs-literal">null</span>,medico,paciente,datos.fecha());
consultaRepository.save(consulta);</code><button type="button" class="clipit">Copia el código</button></pre><p>El método agendar() en la clase Service hará lo siguiente: obtenemos el ID y cargamos el paciente y el médico desde la base de datos; creamos una entidad consulta pasando el médico, el paciente y la fecha que viene en el DTO; y lo guardamos en la base de datos.</p>
<p>Pero antes de eso, necesitamos escribir el código para realizar todas las validaciones que forman parte de las reglas de negocio.</p>
<p>El código de las reglas de negocio aparecerá antes del último fragmento que implementamos en este video. A continuación, abordaremos cómo realizar las validaciones de la mejor manera posible.</p>
<hr>
<p>Para verificar el ID del paciente, usaremos un if. La idea es comprobar si el ID del paciente existe. El Repository es el que consulta la base de datos.</p>
<p>Podemos lanzar una excepción dentro del if, que muestre un mensaje que indique el problema. Incluso podemos crear una excepción personalizada para nuestro proyecto llamada ValidacaoException().</p>
<p>Dentro de los paréntesis, escribimos el mensaje como una cadena ("El ID del paciente proporcionado no existe" o algo similar).</p>
<pre class="prettyprint"><code class="hljs language-scss">public DatosDetalleConsulta <span class="hljs-built_in">agendar</span>(DatosAgendarConsulta datos){

   <span class="hljs-built_in">if</span>(!pacienteRepository.findById(datos.idPaciente())<span class="hljs-selector-class">.isPresent</span>()){
       throw new <span class="hljs-built_in">ValidacionDeIntegridad</span>("este id para el paciente no fue encontrado");
   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Recibiremos un error de validación porque la clase exception no existe. Con el cursor del mouse sobre ella, usaremos el atajo "ALT + Enter" y seleccionaremos la opción "Create Class" (Crear clase).</p>
<p>En "Destination package" (Paquete de destino), dejaremos la clase en el paquete "domain" ("med.voll.api.domain"), ya que no es específica de ninguna funcionalidad. A continuación, seleccionaremos el botón "OK".</p>
<p>Con esto, IntelliJ creará la excepción automáticamente. Heredará de Throwable, pero lo cambiaremos a RuntimeException.</p>
<p>Ya creará un constructor que recibe la cadena, pero coloca el parámetro con el nombre "s". Renombraremos este parámetro como "mensaje".
Dentro del constructor, llamaremos al constructor de la clase madre usando la palabra "super" y pasando el parámetro "mensaje".</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValidacionDeIntegridad</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> {
   <span class="hljs-keyword">public</span> <span class="hljs-title function_">ValidacionDeIntegridad</span><span class="hljs-params">(String s)</span> {
       <span class="hljs-built_in">super</span>(s);
   }
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Continuando con la clase "AgendaDeConsulta", haremos la verificación con el if creado. Primero, verificaremos si existe un paciente con el ID que está llegando a la base de datos. Si no existe, se lanzará una excepción con un mensaje de error.</p>
<p>Existe un método en la interfaz Repository en Spring Data llamado existsById. Realiza una consulta a la base de datos para verificar si existe un registro con un determinado ID. Devuelve un booleano: true si existe y false si no existe.</p>
<p>Usaremos este método existsById, pasando como parámetro datos.idMedico(). Negaremos la expresión agregando un signo de exclamación al inicio. Con esto, si no hay un paciente con el ID en la base de datos, debemos detener la ejecución del programa.</p>
<pre class="prettyprint"><code class="hljs language-scss"><span class="hljs-built_in">if</span>( !medicoRepository.existsById(datos.idMedico())){
   throw new <span class="hljs-built_in">ValidacionDeIntegridad</span>("este id para el medico no fue encontrado");
}</code><button type="button" class="clipit">Copia el código</button></pre><p>nuestra última regla de negocio en Trello dice lo siguiente:</p>
<p>"La elección del médico es opcional, y en ese caso el sistema debe elegir aleatoriamente algún médico disponible en la fecha/hora indicada".</p>
<p>Por lo tanto, es posible que un ID de médico no llegue en la solicitud. Volviendo a IntelliJ, no podemos llamar a existsById si el ID del médico está nulo. Esto resultará en un error para JPA.</p>
<p>Solo podemos llamar al if si el ID no es nulo. Por lo tanto, agregaremos una condición al if antes de la condición actual:</p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-keyword">if</span>(datos.idMedico()!=<span class="hljs-literal">null</span> &amp;&amp; !medicoRepository.existsById(datos.idMedico())){
   <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidacionDeIntegridad(<span class="hljs-string">"este id para el medico no fue encontrado"</span>);
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Los dos "ifs" se utilizan para asegurarse de que llegue un ID existente en la base de datos. La excepción devuelve un mensaje que describe el error de manera más apropiada para el cliente de la aplicación.</p>
<p>El código sólo llegará a la sección que crea las variables si el ID que llega está en la base de datos. En el caso del médico, al ser un campo opcional, puede ser que la línea "var medico = medicoRepository.findById(dados.idMedico()).get()" tenga un idMedico nulo.</p>
<p>De acuerdo con la regla de negocio que acabamos de analizar, necesitamos escribir un algoritmo que elija aleatoriamente un médico en la base de datos. Por lo tanto, la línea anterior necesita ser reemplazada. Como todavía no tenemos el algoritmo, crearemos un método privado en la clase para llamarlo:</p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-keyword">var</span> medico = seleccionarMedico(datos);</code><button type="button" class="clipit">Copia el código</button></pre><p>Obtendremos un error indicando que el método 'seleccionarMedico' no existe. Presionaremos el atajo "ALT + Enter" y elegiremos la opción "Crear método 'seleccionarMedico' en 'AgendaDeConsultas'". El método se crea como privado, pero su tipo de retorno es void, lo cual reemplazaremos por un objeto de tipo Medico.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-keyword">private</span> <span class="hljs-title class_">Medico</span> <span class="hljs-title function_">seleccionarMedico</span>(<span class="hljs-params">DatosAgendarConsulta datos</span>) {

}</code><button type="button" class="clipit">Copia el código</button></pre><p>Esto sirve para aislar el algoritmo y evitar que esté suelto dentro del método de programación de citas. En escolherMedico, necesitamos verificar si está llegando el ID del médico en la solicitud o no.</p>
<p>Si lo está, obtendremos el médico correspondiente de la base de datos. Si no es así, debemos elegir aleatoriamente un profesional de la salud, según lo indica la regla de negocio. A continuación, abordaremos la implementación de este algoritmo y cómo podemos elegir un médico aleatorio de la base de datos.</p>
<p>Ahora, necesitamos implementar el algoritmo que elige al médico de manera aleatoria en caso de que la persona que realiza la solicitud no haya elegido un profesional de la salud para atenderla al programar la cita.</p>
<p>Tenemos que cubrir todos los posibles escenarios. La primera comprobación que haremos es si la persona eligió un médico al hacer la solicitud, usando if (dados.idMedico() != null).</p>
<p>En este caso, cargaremos la información de la base de datos con return medicoRepository.getReferenceById(dados.idMedico()). En lugar de usar findById(), podemos usar getReferenceById() y no necesitamos llamar al .get() que usamos anteriormente.</p>
<p>También podemos cambiar findById() por getReferenceById() en la variable paciente, ya que no queremos cargar el objeto para manipularlo, sino solo para asignarlo a otro objeto.</p>
<p>Volviendo al método 'seleccionarMedico' (), lo primero que estamos haciendo es verificar si la persona que realiza la solicitud solicitó un médico específico para su atención. Si es así, simplemente cargamos la información del médico que viene de la base de datos.</p>
<pre class="prettyprint"><code class="hljs language-kotlin"><span class="hljs-keyword">private</span> Medico seleccionarMedico(DatosAgendarConsulta datos) {
   <span class="hljs-keyword">if</span>(datos.idMedico()!=<span class="hljs-literal">null</span>){
       <span class="hljs-keyword">return</span> medicoRepository.getReferenceById(datos.idMedico());
   }

  <span class="hljs-keyword">return</span> medicoRepository.getReferenceById(datos.idMedico);
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Por el momento, la información que se encuentra en el DTO es idMedico, idPaciente y LocalDateTime fecha. Añadiremos una coma después de fecha y declararemos la especialidad como Especialidad especialidad. Sin embargo, no podemos agregar la anotación @NotNull ya que es opcional. Solo es obligatoria cuando no tenemos el ID del médico.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">record</span> <span class="hljs-selector-tag">DatosAgendarConsulta</span>(
       <span class="hljs-variable">@NotNull</span>
       Long idPaciente,
       Long idMedico,
       <span class="hljs-variable">@NotNull</span>
       <span class="hljs-variable">@Future</span>
       LocalDateTime fecha,
       Especialidad especialidad) {
}</code><button type="button" class="clipit">Copia el código</button></pre><p>Volveremos a la clase "AgendamientoDeConsultas" para editar el método seleccionarMedico(). Si el registro no entró en el if (no se solicitó un médico específico), esto significa que el ID del médico es nulo. En este caso, la especialidad debe haber sido completada. Si no está completada, lanzaremos una excepción.</p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-keyword">if</span>(datos.especialidad()==<span class="hljs-literal">null</span>){
   <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidacionDeIntegridad(<span class="hljs-string">"debe seleccionarse una especialidad para el medico"</span>);
}
</code><button type="button" class="clipit">Copia el código</button></pre><p>Si ninguno de estos if fue aplicado, está todo bien. Esto significa que no se eligió un médico, pero se eligió una especialidad. Ahora, necesitamos seleccionar un médico aleatorio que atienda la especialidad elegida.</p>
<p>Entonces, necesitamos hacer una consulta a la base de datos. ¿Pero cómo elegimos un médico aleatorio de la especialidad elegida que esté disponible en la fecha y hora seleccionadas?</p>
<p>Existen varias formas de hacer esto: podríamos cargar los médicos, filtrarlos por especialidad y comprobar la fecha de la consulta en Java.</p>
<p>Lo ideal es cargar un profesional aleatorio directamente de la base de datos. Sin embargo, esta consulta es específica para nuestro proyecto, es decir, no está lista en Spring Data JPA.</p>
<p>Necesitaremos crear un método para hacer esto:</p>
<pre class="prettyprint"><code class="hljs language-kotlin"><span class="hljs-keyword">return</span> medicoRepository.seleccionarMedicoConEspecialidadEnFecha(datos.especialidad(),datos.fecha());</code><button type="button" class="clipit">Copia el código</button></pre><p>Obtendremos un error de compilación porque este método aún no existe en nuestro medicoRepository. Usaremos el atajo "ALT + Enter" y elegiremos la primera opción sugerida por IntelliJ: "Create method 'seleccionarMedicoConEspecialidadEnFecha' in 'MedicoRepository'".</p>
<p>Sin embargo, escribimos este método en portugués. No estamos siguiendo el estándar de nomenclatura en portugués, como el findAllByAtivoTrue(). De esta manera, Spring Data no podrá construir el SQL automáticamente. La idea es precisamente esa: para este método, nosotros escribiremos el comando SQL.</p>
<p>Para hacerlo, usaremos la anotación @Query() justo encima del método. Viene del paquete "org.springframework.data.jpa". Importaremos la anotación y, entre paréntesis, construiremos la consulta utilizando la sintaxis del Java Persistence Query Language (JPQL).</p>
<p>En nuestro caso, construiremos una consulta. Para facilitar la visualización, dejaremos la consulta dividida por líneas y usaremos el Text block. Esto nos permite escribir el código y dividir las líneas de manera más simple, sin tener que concatenar todo con "+".</p>
<p>¿Por dónde empezamos? Por lo obvio: escribiendo select m from Medico m dentro de la consulta. Si lo dejamos así, se cargarán todos los médicos de la base de datos.</p>
<p>Eso no es lo que queremos. Por lo tanto, debemos filtrar usando m.activo = 1. Recuerda que solo queremos cargar médicos activos. Esta es una de las reglas de negocio que están en nuestro Trello.</p>
<p>Sin embargo, todavía estamos trayendo todos los médicos activos. Por eso, filtraremos una vez más centrándonos en la especialidad: m.especialidad = :especialidad. El : sirve para indicar que se trata del mismo parámetro del método.</p>
<pre class="prettyprint"><code class="hljs language-python"><span class="hljs-meta">@Query(<span class="hljs-params"><span class="hljs-string">"""
       select m from Medico m
       where m.activo= 1
       and
       m.especialidad=:especialidad
            """</span></span>)</span></code><button type="button" class="clipit">Copia el código</button></pre><p>Con esto, estamos pidiendo que el código nos traiga todos los médicos activos que sean de la especialidad seleccionada por el usuario.</p>
<p>Sin embargo, no queremos que traiga todos los médicos de esa especialidad, sino solo uno. ¿Cómo lo hacemos? Escribiendo "limit 1". De esta manera, solo se traerá un registro.</p>
<p>Sin embargo, de esta manera siempre tendremos el mismo médico para la especialidad. ¿Cómo obtenemos un médico elegido aleatoriamente? Escribiendo "order by rand()", donde "rand()" significa "aleatorio".</p>
<p>Ahora, se traerán todos los médicos, ordenados de manera aleatoria. Luego, pedimos que solo se traiga el primer registro.</p>
<pre class="prettyprint"><code class="hljs language-python"><span class="hljs-meta">@Query(<span class="hljs-params"><span class="hljs-string">"""
       select m from Medico m
       where m.activo= 1
       and
       m.especialidad=:especialidad
       order by rand()
       limit 1
       """</span></span>)</span></code><button type="button" class="clipit">Copia el código</button></pre><p>Aún no hemos terminado. Por ahora, estamos trayendo un médico de una especialidad determinada de manera aleatoria. Sin embargo, necesitamos un profesional que esté disponible en el día y horario seleccionado por el usuario. Con el código actual, es posible que estemos trayendo a un médico con la agenda completa en la fecha seleccionada. ¿Cómo filtramos esto? Necesitamos consultar la tabla de consultas. Después de la especialidad, agregaremos otro "and" y escribiremos "m.id not in()". Con esto, estamos pidiendo que se traigan los médicos cuyo ID no esté en esta subselección. Dentro de la subselección, escribiremos: </p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-keyword">select</span> c.medico.id <span class="hljs-keyword">from</span> Consulta c
<span class="hljs-keyword">where</span>
c.fecha=:fecha</code><button type="button" class="clipit">Copia el código</button></pre><p>Este subselect está trayendo el ID de los médicos que tienen una consulta en la fecha seleccionada. Con el not in(), evitaremos los médicos de esta lista. El código completo quedaría de la siguiente forma:</p>
<pre class="prettyprint"><code class="hljs language-python"><span class="hljs-meta">@Query(<span class="hljs-params"><span class="hljs-string">"""
       select m from Medico m
       where m.activo= 1
       and
       m.especialidad=:especialidad
       and
       m.id not in( 
           select c.medico.id from Consulta c
           where
           c.fecha=:fecha
       )
       order by rand()
       limit 1
       """</span></span>)</span></code><button type="button" class="clipit">Copia el código</button></pre>
		</div>
		<div class="task-actions screenReader-only">
			






    
        
        <a href="https://app.aluracursos.com/forum/curso-spring-boot-3-api-para-su-implementacion/exercicio-haga-lo-que-hicimos-en-aula/84601/novo" class=" task-actions-button task-actions-button-forum bootcamp-secondary-button-theme" target="_blank" style="display: none;">
            
                
                
                    Discutir en el Foro
                
            
        </a>
    



			
				
					<button class="task-actions-button task-actions-button-answer task-body-actions-button task-actions-button-showOpinion bootcamp-primary-button-theme" aria-expanded="true">Ver opinión del instructor</button>
				
				
			
		</div>
		
			





<section id="task-feedback" class="task-feedback task-feedback--visible" aria-hidden="false">
	<section class="task-feedback-banner">
		<div class="container">
			<h3 class="task-feedback-banner-title">
				Opinión del instructor
			</h3>
		</div>
		







<div class="video settings">
	<button type="button" class="settings-button" aria-label="Configuraciones">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo nocturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://app.aluracursos.com/suggestions/new/spring-boot-3-api-para-su-implementacion/84601/opinion">Sugerir alteración</a></li>
					
				
			
			
		</ul>
		<span class="settings-box-title"></span>
	</div>
</div>

	</section>
	
				<div class="formattedText" data-external-links="">
					<p>Continúe con sus estudios, y si tiene alguna pregunta, ¡no dude en usar nuestro foro!</p>
				</div>
			
</section>
		
	</div>
</section>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

				
					






	
	
		<section class="task-actions" style="display: block;">
			<div class="container">
				






    
        
        <a href="https://app.aluracursos.com/forum/curso-spring-boot-3-api-para-su-implementacion/exercicio-haga-lo-que-hicimos-en-aula/84601/novo" class=" task-actions-button task-actions-button-forum bootcamp-secondary-button-theme" target="_blank">
            
                
                
                    Discutir en el Foro
                
            
        </a>
    



				
				
				
				
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84601/next" style="background-color: #2A7AE4" class="task-actions-button task-body-actions-button task-actions-button-next bootcamp-next-button bootcamp-primary-button-theme">Próxima Actividad</a>
				
			</div>
		</section>
	


				
				
			</main>
		</div>
	</section>
	

















<button title="Abrir menú/Cerrar menú" aria-label="Abrir menú/Cerrar menú" type="button" class="openMenu-button task-body-button openMenu-button--inactive">
</button>

<aside class="task-menu task-menu-iframe" style="position: fixed;">
	<section class="task-menu-header">
		<button title="Abrir menú" aria-label="Abrir menú" type="button" class="openMenu-button task-menu-button openMenu-button--inactive"></button>
		<div class="task-menu-header-info">
			<a class="task-menu-header-info-title" href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion" title="Ir para la página del curso">
				
					
					
						<img src="./loqueHicimos_files/spring-boot-3-api-para-su-implementacion.svg" alt="ícone Spring Boot 3: documentar, probar y preparar una API para su implementación" class="task-menu-header-info-title-icon " width="37.5px" height="37.5px">
					
				
				<h2 class="task-menu-header-info-title-text">Spring Boot 3: documentar, probar y preparar una API para su implementación</h2>
			</a>
			
				<div class="task-menu-header-info-progress">
					
					<span class="task-menu-header-info-progress-percentage ">25%</span>
					
						
						
						
							
						
					
					<span class="task-menu-header-info-progress-bar" style="background-image: linear-gradient(to right, #9de482, #9de482 25%, transparent 25%);"></span>
				</div>
			

		</div>
	</section>
	
		<form class="task-menu-header-search" target="_blank" action="https://app.aluracursos.com/search/course/spring-boot-3-api-para-su-implementacion" method="get">
			<label class="task-menu-header-search-title" for="query">Buscar en este curso</label>
			<input class="task-menu-header-search-input" name="query" id="query" type="text" required="">
			<button class="task-menu-header-search-button">Buscar <img aria-hidden="true" class="task-menu-header-search-button-img" src="./loqueHicimos_files/icon-new-page.svg"></button>
		</form>
	
	
	<section class="task-menu-section sr-only">
		<div class="task-menu-section-title">
			<span class="task-menu-section-title-number ">Aula<strong>01</strong>
				<span>de 05</span>
			</span>
			<h3 class="task-menu-section-title-text">
				Agendamiento de consultas
			</h3>
		</div>
	</section>
	<section class="task-menu-sections">
		<h2 class="task-menu-sections-title">
			Clase actual
		</h2>
		<select class="task-menu-sections-select" onchange="location.href=&#39;/course/spring-boot-3-api-para-su-implementacion/section/&#39;+this.value+&#39;/tasks&#39;;">
			
				<option value="11458" selected="">01. Agendamiento de consultas</option>
			
				<option value="11459">02. Reglas de negocio</option>
			
				<option value="11460">03. Documentación de la API</option>
			
				<option value="11461">04. Tests automatizados</option>
			
				<option value="11462">05. Build del proyecto</option>
			
		</select>
	</section>
	<nav class="task-menu-nav">
		<h2 class="task-menu-nav-title">
			Actividades
			<span>13 de 14</span>
		</h2>
		<ul class="task-menu-nav-list">
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84343" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">01</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Presentación">
							Presentación
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el Vídeo">05min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84630" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicación completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#HQ_EXPLANATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">02</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Proyecto del curso anterior">
							Proyecto del curso anterior
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84629" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicación completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#SETUP_EXPLANATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">03</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Preparando el ambiente">
							Preparando el ambiente
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84344" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">04</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Nueva funcionalidad">
							Nueva funcionalidad
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el Vídeo">06min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84345" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">05</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Consulta controller">
							Consulta controller
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el Vídeo">15min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84620" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicación completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#COMPLEMENTARY_INFORMATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">06</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Para saber más: anotacion @JsonAlias">
							Para saber más: anotacion @JsonAlias
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84621" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicación completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#COMPLEMENTARY_INFORMATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">07</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Para saber más: formatacion de fechas">
							Para saber más: formatacion de fechas
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84346" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">08</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Clase Service">
							Clase Service
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el Vídeo">12min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84347" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">09</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Validaciones de integridad">
							Validaciones de integridad
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el Vídeo">08min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84622" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicación completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#COMPLEMENTARY_INFORMATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">10</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Para saber más: Service Pattern">
							Para saber más: Service Pattern
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84348" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">11</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Selección medico aleatorio">
							Selección medico aleatorio
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el Vídeo">18min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84570" class="task-menu-nav-item-link task-menu-nav-item-link-SINGLE_CHOICE">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Única opción completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#SINGLE_CHOICE"></use>
					</svg>
					<span class="task-menu-nav-item-number">12</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Consultas con @Query">
							Consultas con @Query
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item task-menu-nav-item--selected">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84601" class="task-menu-nav-item-link task-menu-nav-item-link-TEXT_CONTENT">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Sin respuesta del estudiante completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#DO_AFTER_ME"></use>
					</svg>
					<span class="task-menu-nav-item-number">13</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Haga lo que hicimos en aula">
							Haga lo que hicimos en aula
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84636" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg " aria-label="Actividad de Explicación inacabada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#WHAT_WE_LEARNED"></use>
					</svg>
					<span class="task-menu-nav-item-number">14</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Lo que aprendimos">
							Lo que aprendimos
						</span>
						
					</span></a>
				</li>
			
			
		</ul>
	</nav>
	<section class="task-menu-others">
		<h2 class="task-menu-others-title ">
			Otros Links
		</h2>
		
			<a class="task-menu-others-link task-menu-others-link-discord" href="https://discord.com/invite/bts3Yzb9uk" target="_blank">
				Discord Alura
			</a>
		
		
			
			<a href="https://app.aluracursos.com/forum/curso-spring-boot-3-api-para-su-implementacion/todos" class="task-menu-others-link task-menu-others-link-forum" title="Ir para el foro do curso" target="_blank">
				
					
					
					
						Foro del curso
					
				
			</a>
		
		<a href="https://app.aluracursos.com/dashboard" class="task-menu-others-link task-menu-others-link-curso" title="Ir para la página principal">Volver al Dashboard</a>
		
		<section class="task-container-flex  --task-button-column">
			
				<div class="task-group-border  --task-closed-border">
					<button class="task-edit-mode settings-box-item-darkmode">Modo nocturno</button>
				</div>
			
		</section>
	</section>
	<section class="task-menu-footer">
		<a class="task-menu-footer-user" href="https://app.aluracursos.com/user/sboboda1997" title="Ir para su página de usuario">
			<img src="./loqueHicimos_files/k-kurt.png" alt="Gravatar de Kevin Sboboda" class="task-menu-footer-img" width="40px" height="40px">
			
				<p class="task-menu-footer-detalhes">
					<span class="task-menu-footer-detalhes-nome">Kevin Sboboda</span>
					<span class="task-menu-footer-detalhes-xp">
						77k xp
					</span>
				</p>
			
			<input type="hidden" value="">
			<input type="hidden" value="">
		</a>
		<a href="https://app.aluracursos.com/dashboard" class="task-menu-footer-logo">
			<img src="./loqueHicimos_files/icon-menu-alura_espanhol.svg" alt="Logo da Alura Latam" class="task-menu-footer-logo-image" width="19px" height="32px" title="Ir para la página principal">
		</a>
	</section>
</aside>




    

</section><div class="full-screen__panel" style="display: none;">
				<img id="full-screen__image" class="full-screen__image" src="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84601" alt="">
				<div class="full-screen__actions">
				<button class="button buttonAction partitura-download">Anterior</button><button class="button buttonAction partitura-download">Sair</button><button class="button buttonAction partitura-download">Próximo</button></div> 
			</div>










	

	<script src="./loqueHicimos_files/jquery-3.6.0.min.7c14a783.js.descarga"></script>
	<script src="./loqueHicimos_files/buttonToggle.41524be9.js.descarga"></script>
	<script src="./loqueHicimos_files/sectionMenu.2bb600e2.js.descarga" async=""></script>
	<script src="./loqueHicimos_files/submitTaskVerifier.e6e3bd5f.js.descarga"></script>

    <script src="./loqueHicimos_files/purify.min.bd253e08.js.descarga"></script>

	<script src="./loqueHicimos_files/caret.2e5c0c9d.js.descarga" async=""></script>
	<script src="./loqueHicimos_files/keydownWatchers.fdc4ec79.js.descarga" async=""></script>

	<script src="./loqueHicimos_files/highlight.min.9b99da81.js.descarga" async=""></script>
	<script src="./loqueHicimos_files/highlight.init.5870d8cf.js.descarga" async=""></script>

	<script src="./loqueHicimos_files/preventsMultipleInteractions.19502e19.js.descarga" async=""></script>
	<script src="./loqueHicimos_files/assessment.78d1fb98.js.descarga" async=""></script>

	<script src="./loqueHicimos_files/menuSettings.fb011b3b.js.descarga"></script>
	<script src="./loqueHicimos_files/aria.a82b16ad.js.descarga"></script>
	<script src="./loqueHicimos_files/ProjectSubmit.1e34b47f.js.descarga"></script>
	<script src="./loqueHicimos_files/LinkSubmit.60d53572.js.descarga"></script>
	<script src="./loqueHicimos_files/classPage.fcad576a.js.descarga"></script>
	<script src="./loqueHicimos_files/phrase.dfd04ee1.js.descarga"></script>
	<script src="./loqueHicimos_files/feedback.7962df4a.js.descarga"></script>
	<script src="./loqueHicimos_files/ExtraContentProgressRequest.aec577c3.js.descarga"></script>
	
	

	
	
	
	
	

	<script src="./loqueHicimos_files/partitura.3e404a17.js.descarga"></script>
	<script src="./loqueHicimos_files/audioProgress.049144a0.js.descarga"></script>
	<script src="./loqueHicimos_files/audioPlayer.38483a63.js.descarga"></script>

		
	<script src="./loqueHicimos_files/VideoTranscription.60f380a7.js.descarga"></script>
	<script src="./loqueHicimos_files/MarkdownProcessing.2cb5d893.js.descarga"></script>
	<script src="./loqueHicimos_files/clipboard.min.af8ab365.js.descarga"></script>
	<script src="./loqueHicimos_files/Clipper.5c96d26f.js.descarga"></script>
	<script src="./loqueHicimos_files/scroll-to-top.373e0d1c.js.descarga"></script>
	<script src="./loqueHicimos_files/shortcuts-action.eba8a7c6.js.descarga"></script>
	<script src="./loqueHicimos_files/ModalAndAlertHandler.9c67ae4b.js.descarga"></script>
    


	<script>
		new VideoTranscription();
		new MarkdownProcessing("https://app.aluracursos.com").onLoad();
		new Clipper("Copia el código", "Código copiado", "No se pudo copiar el código");
		window.addEventListener('load', () => new BackToTopButton().init());
		new ModalAndAlertHandler('spring-boot-3-api-para-su-implementacion').setupListeners();
	</script>



	

	<script src="./loqueHicimos_files/darkMode.b7bc2dd7.js.descarga"></script>

	
		




<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-42101548-21', 'aluracursos.com');

    
        ga('set', 'userId', '576082');
    

    ga('require', 'displayfeatures');
    
    ga('send', 'pageview');
    
    
</script>
	

	<script>new DarkModeToggler().refreshListener()</script>
    



































<link href="./loqueHicimos_files/uploadImages.7c1a29db.css" rel="stylesheet">

<script src="./loqueHicimos_files/UploadProgress.098aba94.js.descarga"></script>
<script src="./loqueHicimos_files/ImagesClient.f10726e3.js.descarga"></script>

<script src="./loqueHicimos_files/marked.min.c69e14e8.js.descarga"></script>

<script src="./loqueHicimos_files/enableForumButtons.1293253c.js.descarga"></script>

<script>
    var IMAGE_UPLOAD_MESSAGES = {
        imageUploadMessageInit: `Adjunte archivos arrastrándolos y soltándolos`,
        imageUploadMessageDragEnter: `Suelta la imagen para subir`,
        imageUploadMessageDrop: `Subiendo la imagen #images_names#`,
        imageUploadMessageProgress: `Subiendo la imagen #images_names#: #progress#%`,
        imageUploadMessageUploaded: `¡Imagen enviada con éxito!`,
        imageUploadMessageSizeUnits: `MB`,
        imageUploadMessageTag: `![Ingrese aquí la descripción de esta imagen para ayudar con la accesibilidad](#url#) `
    }
</script>


    
        <link href="./loqueHicimos_files/hackeditor.min.fcf421a7.css" rel="stylesheet">
        <link href="./loqueHicimos_files/hackeditor.custom.e0057fb6.css" rel="stylesheet">
        <link href="./loqueHicimos_files/github.754087c4.css" rel="stylesheet">

        <script src="./loqueHicimos_files/hackeditor.min.4c55d65b.js.descarga"></script>
        <script src="./loqueHicimos_files/hackeditor.custom.b88c034d.js.descarga"></script>
        <script src="./loqueHicimos_files/highlight.min.9b99da81.js.descarga"></script>
        <script>
            const setupEditorsOnPage = (e) => {
                const toolbarActionsHints = {
                    toggleHeadingActionHint: `Encabezado`,
                    toggleBoldActionHint: `Negrito`,
                    toggleItalicActionHint: `Cursiva`,
                    toggleOrderedListActionHint: `Lista ordenada`,
                    toggleUnorderedListActionHint: `Lista desordenada`,
                    togglePreviewActionHint: `Alternar vista previa`,
                    drawTableActionHint: `Insertar tabla`,
                    drawCodeActionHint: `Insertar bloque de código`,
                    drawLinkActionHint: `Insertar enlace`,
                    drawImageActionHint: `Insertar imagen`,
                    drawUploadedImageActionHint: `Carga de imagen`,
                    undoActionHint: `Deshacer`,
                    redoActionHint: `Rehacer`
                }

                const imageUploadErrors = {
                    imageErrorLimit: `¡Solo puede insertar 5 imágenes a la vez!`,
                    imageFileNotAllowed: `El archivo filename no está permitido, ¡solo imágenes!`,
                    imageVeryLarge: `El archivo filename supera el límite de 2 MB.`,
                    imageMaliciousFile: `El archivo filename contiene contenido malicioso.`
                }

                window.editors = window.editors || [];

                const editorsElements = window.editors.map(ed => ed.element.id);

                const textAreaEditors = Array.from(document.querySelectorAll('.hackeditor > textarea'));
                textAreaEditors
                    .filter(e => e.closest('.taskForms') == null)
                    .filter(e => editorsElements.length == 0 ? true : !editorsElements.includes(e.id))
                    .forEach(editorTextArea => {
                        const editor = setupHackEditor({
                            editorOptions: {
                                element: editorTextArea,
                                initialValue: editorTextArea.innerText,
                                syncPreview: true,
                                maxHeight: "300px",
                                toolbarActionsHints,
                                imageUploadMessages: IMAGE_UPLOAD_MESSAGES,
                                imageUploadErrors,
                                imageUploadClient: new ImagesClient(
                                    'https://www.gnarususercontent.com.br/images',
                                    'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2MTc4MDcxMzMsImtleSI6IjRiYWRlNDg1LTFjYjYtNDYzNy1iMTRlLWIxYTY2MzRhZDYyNyJ9.VHSsMMu_Qmm9G5HbJD9jA86B2hddM07XRbObvZRh0Ns',
                                    6,
                                    576082
                                ),
                                allowImageUpload: editorTextArea.dataset.allowImageUpload
                            },
                            extensions: {
                                DOMPurify,
                                marked,
                                hljs
                            }
                        });

                        window.editors.push({
                            instance: editor,
                            element: editorTextArea,
                        });

                        enableForumButtons();
                });
            }

            window.addEventListener('DOMContentLoaded', setupEditorsOnPage);
            document.addEventListener('change', setupEditorsOnPage);
        </script>
    
    

<script src="./loqueHicimos_files/IframeChecker.05103d26.js.descarga"></script>



<button class="back-to-top" type="button" style="display: none;"><span class="back-to-top__text">Voltar ao topo</span></button></body></html>