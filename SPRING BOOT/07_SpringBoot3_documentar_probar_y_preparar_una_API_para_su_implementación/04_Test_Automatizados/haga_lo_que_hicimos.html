
<!-- saved from url=(0086)https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84616 -->
<html lang="pt-BR" data-product="alura_espanhol" style="scroll-behavior: smooth;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" type="text/css" href="./haga_lo_que_hicimos_files/clipper.647d33f8.css">
<link rel="stylesheet" href="./haga_lo_que_hicimos_files/back-to-top.9a8b5967.css">
<link rel="stylesheet" href="./haga_lo_que_hicimos_files/videoShortcutsModal.e1c7fc31.css">
<link rel="stylesheet" href="./haga_lo_que_hicimos_files/modal.5da2b30a.css">
<link rel="stylesheet" href="./haga_lo_que_hicimos_files/modalCoursePreviewMode.fe9f769f.css">

























	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	

	

	
		




    
        
        
            <!-- Google Tag Manager -->
            <script type="text/javascript" async="" src="./haga_lo_que_hicimos_files/js"></script><script async="" src="./haga_lo_que_hicimos_files/analytics.js.descarga"></script><script type="text/javascript" async="" src="./haga_lo_que_hicimos_files/js(1)"></script><script async="" src="./haga_lo_que_hicimos_files/gtm.js.descarga"></script><script>
                ;(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayerAlura','GTM-PFCN2KV');
            </script>
            <!-- End Google Tag Manager -->
        
    


    <script>
        let dataLayerAluraTest = window.dataLayerAluraTest || [];
        let dataLayerAlura = window.dataLayerAlura || [];
        dataLayerAlura.push({
            'event': 'virtual_page_view',
            'page_category': 'Aula',
            
            
            
                
                    
                    
                        
                        'user_id': '576082',
                        'plan': 'Oracle Next Education F2 T5',
                        'type': 'B2B',
                        'company_id':'5013',
                        'first_purchase_date': '2023-03-28',
                        'last_purchase_date': '2023-03-28',
                        'expiration_date': '2023-10-04',
                        'email': 'b7a5de8d38d6e9c501dc677df972f9557de039ce9e8dc8976e0d6c048a508798'
                    
                
            
        });
    </script>





	

	<title>Spring Boot 3: documentar, probar y preparar una API para su implementaci贸n: Aula 4 - Actividad 9 Haga lo que hicimos en aula | Alura Latam - Cursos online de tecnologia</title>
	
	<link rel="shortcut icon" href="https://app.aluracursos.com/assets/images/aluraespanhol/favicon.ico">
	
	<link href="./haga_lo_que_hicimos_files/css" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.gstatic.com/">

	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/video-js.7b9aee00.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/silvermine-videojs-quality-selector.min.de928d55.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/prettify.9c184279.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/github.754087c4.css">

	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/base.f643e441.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/formattedText.e58775de.css">
	
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/container.ca700c42.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/classPage.ee5a0101.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/menuSettings.825e8801.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/taskProgress.a5300583.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/taskMessageInfo.67eb9bc6.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/alternativeList.a80939d3.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/taskFeedback.4bda0782.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/markdown.3ec31c65.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/finishSection.bee005cf.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/phrase.6d459a32.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/hqexplanation.3ed41021.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/openquestion.2889f14f.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/textcontent.7298b79f.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/video.e82ab0eb.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/singlechoice.b545e19f.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/music.8fe6cab6.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/multiplechoice.70f60e4c.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/videodialog.36286910.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/fillintheblank.59273039.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/speakingpractice.13b2c5c5.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/pronunciationpractice.d512f574.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/repetition.492af846.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/genericVideo.4767d8de.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/projectSubmit.ce2f9d80.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/sortBlocks.7b9eb1fc.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/extraContentTask.b2d126e6.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/taskContent.1ef47209.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/taskButtons.ed4fd65b.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/alert.ec6bb786.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/markdownEditor.600de57a.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/audioPlayer.0a362c88.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/notes.867f62ab.css">
	
	
	
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/successMessage.cb6c074e.css">

	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/dark-mode.0598a04f.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/taskFeedbackAnswer.72669c00.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/theater-mode.91e2f524.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/autoplay-videojs.eefac430.css">
	<link rel="stylesheet" href="./haga_lo_que_hicimos_files/linkSubmit.ddbc8743.css">

	
	
	<style type="text/css">
		.task:before, .video-js .vjs-play-progress {
			background-color: #2A7AE4;
		}


	</style>

	<!-- Remove cookie banner from hubspot -->
	<style>
		div#hs-eu-cookie-confirmation {
			display: none;
		}
	</style>

	<meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AymqwRC7u88Y4JPvfIF2F37QKylC04248hLCdJAsh8xgOfe/dVJPV3XS3wLFca1ZMVOtnBfVjaCMTVudWM//5g4AAAB7eyJvcmlnaW4iOiJodHRwczovL3d3dy5nb29nbGV0YWdtYW5hZ2VyLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjk1MTY3OTk5LCJpc1RoaXJkUGFydHkiOnRydWV9"></head>




<body class="darkmode ">
<script src="./haga_lo_que_hicimos_files/avatarOnError.f8bd8956.js.descarga"></script>




	


<!-- Google Tag Manager (noscript) -->
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PFCN2KV"
				  height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->



<section class="task menu--inactive" data-allow-answer="true" data-task-section-exam="false" data-task-type="textcontent" data-task-id="84616" data-author-id="576082" data-course-code="spring-boot-3-api-para-su-implementacion" data-section-name="Tests automatizados" data-section-id="11461" data-section-number="4" data-domain="app.aluracursos.com" data-hasfeedbackanswer="false" data-url-prefix="/" data-already-seen-task="true" data-course-name="Spring Boot 3: documentar, probar y preparar una API para su implementaci贸n" data-category-name="Programaci贸n" data-subcategory-name="Java" data-workload="12" data-teachers="jose viera">

	<section class="task-body">
		
		











<header class="task-body-header">
    













    <div class="container">

        
            
            <button title="Abrir menu" aria-label="Abrir menu" type="button" class="theatermode openMenu-button task-menu-button" id="menu-button-header">
            </button>
        

        <h1 class="task-body-header-title">
            
            
            <svg class="task-body-header-title-svg" aria-label="Actividad de Sin respuesta del estudiante">
                <use xlink:href="/assets/images/classPage/icon-menu-icons.svg#DO_AFTER_ME"></use>
            </svg>
            <small>09</small>
            <span class="task-body-header-title-text"> Haga lo que hicimos en aula</span>
        </h1>
        
            <div class="task-body-header-actions">
                <a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84616/next" aria-hidden="true" class="task-actions-button task-actions-button-next task-submit bootcamp-primary-button-theme" style="background-color: #2A7AE4">Pr贸xima Actividad</a>
            </div>
        


        
            







<div class="theater-video settings">
	<button type="button" class="settings-button" aria-label="Configuraciones">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo nocturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://app.aluracursos.com/suggestions/new/spring-boot-3-api-para-su-implementacion/84616/question">Sugerir alteraci贸n</a></li>
					
				
			
			
		</ul>
		<span class="settings-box-title"></span>
	</div>
</div>

        
    </div>
</header>
		<div class="task-body__wrapper">
			



<section class="class-notes">
    <div class="class-notes-content">
        <h2 class="class-notes-title">Mi cuaderno del curso (beta)</h2>
        <p class="class-notes-description">Este es su cuaderno de anotaciones aqu铆 en Alura Latam. Todo su contenido es visible apenas para t铆.<a href="https://suporte.alura.com.br/article/308-meu-caderno-como-funciona" class="class-notes-faq-link">FAQ</a></p>
        <textarea name="text" id="courseNotebook-text" class="class-notes-text" cols="30" rows="10" maxlength="60000"></textarea>
        <div class="class-notes-save-wrapper">
            <span>
                <p class="class-notes-saved-text" aria-hidden="true" style="display: none">Notas guardadas</p>
                <p class="class-notes-limit-text" aria-hidden="true" style="display: none">隆No se pudo guardar! 隆L铆mite de caracteres alcanzado ({max})!</p>
            </span>
            <span class="class-notes-save-button-wrapper">
                <button class="class-notes-save-button" data-save-text="Guardar cuaderno" data-saving-text="Guardandando">
                   Guardar cuaderno</button>
            </span>
        </div>
        <button class="class-notes-close-button"></button>
    </div>
</section>
			<main class="task-body-main container" data-should-warn="false">
				







	
	
	
		





<section id="task-content" class="textContent">
	
	<div class="container">
		







<div class="video settings">
	<button type="button" class="settings-button" aria-label="Configuraciones">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo nocturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://app.aluracursos.com/suggestions/new/spring-boot-3-api-para-su-implementacion/84616/question">Sugerir alteraci贸n</a></li>
					
				
			
			
		</ul>
		<span class="settings-box-title"></span>
	</div>
</div>

		<div class="formattedText" data-external-links="">
			<p>Una de las pruebas que haremos es la de las interfaces Repository.</p>
<p>Necesitamos escribir una prueba automatizada y, en el caso de Java, la biblioteca est谩ndar es JUnit. La primera acci贸n l贸gica a tomar es agregar JUnit al proyecto como una dependencia.</p>
<p>Con IntelliJ abierto, abriremos el archivo "pom.xml". Si observamos las dependencias del proyecto, tenemos las de Spring Boot, Lombok, MySQL, Flyway, pero no JUnit. La verdad es que no necesitamos agregar esta dependencia porque ya est谩 integrada en el proyecto.</p>
<p>En el primer curso, cuando creamos el proyecto en el sitio de Spring Initializr, autom谩ticamente agreg贸 la siguiente dependencia a nuestro proyecto:</p>
<pre class="prettyprint"><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Por lo tanto, ser铆a interesante crear una prueba para nuestra interfaz MedicoRepository y escribir escenarios de prueba para este m茅todo seleccionarMedicoConEspecialidadEnFecha.</p>
<p>Haremos esto seleccionando el m茅todo deseado y utilizando el atajo "ALT + Insert". De las opciones que aparecen en la pantalla, seleccionaremos la opci贸n "Test".</p>
<p>Se abrir谩 una nueva ventana. All铆, tendremos el nombre de la nueva clase de pruebas siguiendo el est谩ndar de JUnit ("MedicoRepositoryTest"). IntelliJ ya insertar谩 esta clase en el paquete "src &gt; test &gt; java", espec铆fico para clases de prueba automatizadas.</p>
<p>Justo debajo, la ventana pide que confirmemos el m茅todo que queremos probar (debajo de "Generate test methods for:"). Hacemos clic en el cuadro de di谩logo junto al m茅todo seleccionarMedicoConEspecialidadEnFecha y seleccionamos el bot贸n "OK".</p>
<p>Se ha creado nuestra clase de prueba. Al expandir el men煤 Project, ver谩 que se cre贸 la carpeta en "src &gt; test &gt; java &gt; med.voll.api &gt; domain medico".</p>
<p>Si ha explorado el proyecto del curso, habr谩 notado que, al crearlo con Spring Initializr, incluso crea una clase de ejemplo de pruebas automatizadas llamada "ApiApplicationTests". Podemos eliminarla, ya que no se utilizar谩.</p>
<p>Para probar una clase Repository, utilizaremos algunos recursos de Spring Boot destinados a pruebas automatizadas. Como queremos probar un Repository, necesitamos insertar la anotaci贸n @DataJpaTest en ella.</p>
<p>En nuestro caso, podemos solicitar que Spring no use la base de datos en memoria, sino la propia base de datos de la aplicaci贸n. Esto resultar谩 en una prueba que sea lo m谩s fiel posible a nuestro entorno. Usaremos esta opci贸n. La desventaja es que la prueba ser谩 un poco m谩s lenta, aunque m谩s fidedigna.</p>
<p>Para usar este enfoque, necesitamos insertar la anotaci贸n @AutoConfigureTestDatabase(). Como par谩metro, escribiremos replace = y presionaremos "CTRL + Espacio" para recibir sugerencias autom谩ticas. Una de ellas es "Replace.NONE". Seleccionamos esto presionando "Enter" y veremos que el par谩metro cambi贸 a replace = AutoConfigureTestDatabase.Replace.NONE.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-variable">@DataJpaTest</span>
<span class="hljs-variable">@AutoConfigureTestDatabase</span>(replace = AutoConfigureTestDatabase.Replace.NONE)
<span class="hljs-variable">@ActiveProfiles</span>(<span class="hljs-string">"test"</span>)
class MedicoRepositoryTest {

   <span class="hljs-variable">@Test</span>
   void <span class="hljs-built_in">seleccionarMedicoConEspecialidadEnFechaEscenario1</span>() {


   }

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Sin embargo, tendremos otro problema: nuestra base de datos ya tiene muchos registros registrados. Esto puede interferir en la prueba automatizada. Lo ideal es que usemos la misma base de datos (MySQL), pero con otra base de datos exclusiva para las pruebas.</p>
<p>Con esto, los datos que ya tenemos en el entorno de desarrollo no afectar谩n a los datos utilizados para las pruebas automatizadas.</p>
<p>Para realizar este cambio, accederemos a "src &gt; main &gt; java &gt; resources &gt; application.properties". Este es el archivo de propiedades de la aplicaci贸n que queremos usar en el entorno de desarrollo, pero queremos otra configuraci贸n para el entorno de pruebas.</p>
<p>Para ello, duplicaremos este archivo haciendo clic en "application.yml" y presionando el atajo "CTRL + C", seguido de "CTRL + V". Luego, renombraremos la copia a "application-test.properties".</p>
<p>Podemos tener varios archivos de propiedades y "-test" funciona como un perfil. As铆, "application.yml" sigue siendo el archivo predeterminado y "application-test.yml" se utiliza solo para el entorno de pruebas.</p>
<p>Abriremos el archivo "-test" y eliminaremos todas las propiedades, excepto la primera, que corresponde a la URL de la base de datos. En ella, modificaremos solo el nombre de la base de datos. En lugar de ser "vollmed_api", ser谩 "vollmed_api_test".</p>
<pre class="prettyprint"><code class="hljs language-yaml"><span class="hljs-attr">spring:</span>
 <span class="hljs-attr">datasource:</span>
   <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost/vollmed_api_test?createDatabaseIfNotExist=true&amp;serverTimezone=UTC</span>
   <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
   <span class="hljs-attr">password:</span> <span class="hljs-number">2812</span></code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Por ahora, no est谩 compilando porque el m茅todo seleccionarMedicoConEspecialidadEnFecha() necesita dos par谩metros: la especialidad y la fecha. Como especialidad, pasamos el par谩metro Especialidad.CARDIOLOGIA.</p>
<p>En cuanto a la fecha, no podemos tomar la fecha actual como par谩metro del m茅todo, ya que cada vez que se ejecute el test, tendremos un d铆a diferente y, por lo tanto, el comportamiento del test tambi茅n ser谩 diferente.</p>
<p>Por eso, crearemos una variable llamada proximoLunes10H. En la l铆nea de arriba, definiremos esta variable como var proximoLunes10H= LocalDate.now().with(TemporalAdjusters.next(DayOfWeek.MONDAY)). Con esto, el pr贸ximo lunes se calcula en funci贸n de la fecha actual. Luego, pasamos la hora utilizando .atTime(10, 0), indicando que son las 10 de la ma帽ana.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-meta">@Test</span>
<span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"deberia retornar nulo cuando el medico se encuentre en consulta con otro paciente en ese horario"</span>)
<span class="hljs-built_in">void</span> <span class="hljs-title function_">seleccionarMedicoConEspecialidadEnFechaEscenario1</span>(<span class="hljs-params"></span>) {

   <span class="hljs-keyword">var</span> proximoLunes10H = <span class="hljs-title class_">LocalDate</span>.<span class="hljs-title function_">now</span>()
           .<span class="hljs-title function_">with</span>(<span class="hljs-title class_">TemporalAdjusters</span>.<span class="hljs-title function_">next</span>(<span class="hljs-title class_">DayOfWeek</span>.<span class="hljs-property">MONDAY</span>))
           .<span class="hljs-title function_">atTime</span>(<span class="hljs-number">10</span>,<span class="hljs-number">0</span>);

   <span class="hljs-keyword">var</span> medicoLibre = medicoRepository.<span class="hljs-title function_">seleccionarMedicoConEspecialidadEnFecha</span>(<span class="hljs-title class_">Especialidad</span>.<span class="hljs-property">CARDIOLOGIA</span>,proximoLunes10H);

   <span class="hljs-title function_">assertThat</span>(medicoLibre).<span class="hljs-title function_">isNull</span>();
}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Podr铆amos ejecutar la prueba ahora, pero 驴qu茅 pasa con la base de datos? Anteriormente, definimos que el banco utilizado ser谩 el mismo que el de la aplicaci贸n, pero con una base de datos espec铆fica para pruebas. Flyway ejecuta las migraciones y crea todas las tablas normalmente en la base de datos de prueba, pero esta est谩 vac铆a.</p>
<p>Esta es otra desventaja de este tipo de prueba automatizada: toda la informaci贸n que debe estar registrada previamente en la base de datos debe hacerse manualmente.</p>
<p>Por lo tanto, antes de llamar al m茅todo seleccionarMedicoConEspecialidadEnFecha(), necesitaremos registrar un m茅dico, un paciente y una consulta en la base de datos, ya que son la informaci贸n necesaria para este escenario.</p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-comment">// Trecho de c贸digo suprimido</span>

<span class="hljs-keyword">var</span> medico =
<span class="hljs-keyword">var</span> paciente =
<span class="hljs-keyword">var</span> consulta =

<span class="hljs-comment">// Trecho de c贸digo suprimido</span></code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Sin embargo, necesitamos un m茅todo para registrar cada una de estas informaciones (m茅dico, paciente y consulta). Podr铆amos inyectar el pacienteRepository y el consultaRepository en la clase, pero tambi茅n es posible utilizar otro enfoque: usar el Entity Manager de la propia JPA.</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> TestEntityManager em;</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Crearemos un nuevo atributo anotado con @Autowired y usaremos el TestEntityManager, utilizado espec铆ficamente para pruebas automatizadas. A continuaci贸n, utilizaremos el Entity Manager para guardar el m茅dico, el paciente y la consulta.</p>
<p>Una buena pr谩ctica es organizar el c贸digo de prueba con m茅todos privados. De esta manera, no dejamos el escenario de pruebas demasiado largo. Adem谩s, esta informaci贸n deber谩 ser utilizada en otros escenarios de prueba. Por lo tanto, los m茅todos privados contienen informaci贸n reutilizable.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">registrarConsulta</span>(<span class="hljs-params">Medico medico, Paciente paciente, LocalDateTime fecha</span>) {
   em.<span class="hljs-title function_">persist</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Consulta</span>(<span class="hljs-literal">null</span>, medico, paciente, fecha, <span class="hljs-literal">null</span>));
}

<span class="hljs-keyword">private</span> <span class="hljs-title class_">Medico</span> <span class="hljs-title function_">registrarMedico</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> nombre, <span class="hljs-built_in">String</span> email, <span class="hljs-built_in">String</span> documento, Especialidad especialidad</span>) {
   <span class="hljs-keyword">var</span> medico = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Medico</span>(<span class="hljs-title function_">datosMedico</span>(nombre, email, documento, especialidad));
   em.<span class="hljs-title function_">persist</span>(medico);
   <span class="hljs-keyword">return</span> medico;
}

<span class="hljs-keyword">private</span> <span class="hljs-title class_">Paciente</span> <span class="hljs-title function_">registrarPaciente</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> nombre, <span class="hljs-built_in">String</span> email, <span class="hljs-built_in">String</span> documento</span>) {
   <span class="hljs-keyword">var</span> paciente = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Paciente</span>(<span class="hljs-title function_">datosPaciente</span>(nombre, email, documento));
   em.<span class="hljs-title function_">persist</span>(paciente);
   <span class="hljs-keyword">return</span> paciente;
}

<span class="hljs-keyword">private</span> <span class="hljs-title class_">DatosRegistroMedico</span> <span class="hljs-title function_">datosMedico</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> nombre, <span class="hljs-built_in">String</span> email, <span class="hljs-built_in">String</span> documento, Especialidad especialidad</span>) {
   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatosRegistroMedico</span>(
           nombre,
           email,
           <span class="hljs-string">"61999999999"</span>,
           documento,
           especialidad,
           <span class="hljs-title function_">datosDireccion</span>()
   );
</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Por ahora, necesitamos un m茅todo para registrar cada una de estas informaciones (m茅dico, paciente y consulta). Podr铆amos inyectar el pacienteRepository y el consultaRepository en la clase, pero tambi茅n es posible utilizar otra aproximaci贸n: usar el Entity Manager de la propia JPA. Crearemos un nuevo atributo anotado con @Autowired y utilizaremos el TestEntityManager, utilizado espec铆ficamente para pruebas automatizadas. Despu茅s, utilizaremos el Entity Manager para guardar el m茅dico, el paciente y la consulta.</p>
<p>Una buena pr谩ctica es organizar el c贸digo de prueba con m茅todos privados. De esta forma, no dejamos el escenario de pruebas demasiado largo. Adem谩s, esta informaci贸n necesitar谩 ser utilizada en otros escenarios de prueba. Por lo tanto, los m茅todos privados contienen informaci贸n reutilizable.</p>
<p>Los m茅todos anteriores sirven para crear los DTOs que representan al m茅dico, al paciente y la consulta, adem谩s de m茅todos para guardarlos en la base de datos usando el Entity Manager.</p>
<p>Volviendo al escenario de prueba, llamaremos a registrarMedico en la l铆nea var medico=. Tendremos que pasar un nombre ("Medico"), un correo electr贸nico ("medico@voll.med"), un documento("123456") y la especialidad del m茅dico (Especialidad.CARDIOLOGIA).</p>
<p>Haremos algo similar con el paciente: llamaremos al m茅todo registrarPaciente, con un nombre ("Paciente"), un correo electr贸nico (paciente@email.com) y un documento (00000000000).</p>
<p>Por 煤ltimo, llamaremos al m茅todo para registrar la consulta (registrarConsulta). Los par谩metros son el m茅dico y el paciente que acabamos de registrar. La fecha es el pr贸ximo lunes a las 10 de la ma帽ana (proximoLunes10H).</p>
<pre class="prettyprint"><code class="hljs language-swift"><span class="hljs-keyword">var</span> medico<span class="hljs-operator">=</span>registrarMedico(<span class="hljs-string">"Jose"</span>,<span class="hljs-string">"j@mail.com"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-type">Especialidad</span>.<span class="hljs-type">CARDIOLOGIA</span>);
<span class="hljs-keyword">var</span> paciente<span class="hljs-operator">=</span> registrarPaciente(<span class="hljs-string">"antonio"</span>,<span class="hljs-string">"a@mail.com"</span>,<span class="hljs-string">"654321"</span>);
registrarConsulta(medico,paciente,proximoLunes10H);</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Con eso, hicimos las llamadas y registramos todo en la base de datos. No necesitamos guardar la consulta en una variable, as铆 que podemos eliminar la l铆nea var consulta = que estaba presente en el c贸digo anterior.</p>
<p>Observa por la Consola que se inicia el servidor y Spring. Adem谩s, la inserci贸n del m茅dico, paciente y consulta se realiz贸. A continuaci贸n, llamamos al m茅todo para hacer la consulta de un m茅dico aleatorio disponible en ese horario y la prueba se realiz贸 con 茅xito. Por lo tanto, esta consulta devuelve un n煤mero.</p>
<p>Un factor importante en las pruebas de Repositorio: todos los registros que insertamos se eliminar谩n al final de la ejecuci贸n del m茅todo para que un m茅todo de prueba no interfiera en los dem谩s. Por lo tanto, cada m茅todo de prueba se ejecuta de manera aislada.</p>
<p>Este es el comportamiento est谩ndar de Spring: al finalizar una prueba, hace el rollback autom谩ticamente. Por lo tanto, cuando se ejecuta una nueva prueba, la base de datos se restablecer谩 a cero.</p>
<p>Una vez creado el primer escenario de prueba, es m谩s f谩cil crear los dem谩s. Ahora haremos el escenario "Deber铆a devolver m茅dico cuando est茅 disponible en la fecha". En este escenario, tenemos un m茅dico registrado, pero est谩 disponible para la consulta. Podemos mantener la misma fecha (proximoLunes10H).</p>
<p>Crearemos un m茅dico en la base de datos. Sin embargo, no necesitamos registrar pacientes ni consultas. Podemos eliminar las dos l铆neas que se refieren a ellas.</p>
<p>Por otro lado, el assert de este escenario no debe ser nulo, en su lugar, reemplazamos el .isNull() por isEqualTo(medico), es decir, debe ser igual al m茅dico registrado anteriormente.</p>
<p>El m茅dico est谩 registrado y se guardar谩 en una variable. Cuando hagamos la consulta para elegir al m茅dico disponible aleatoriamente, medicoLibre debe ser el resultado, ya que es el 煤nico disponible en la fecha.</p>
<pre class="prettyprint"><code class="hljs language-typescript"><span class="hljs-meta">@Test</span>
<span class="hljs-meta">@DisplayName</span>(<span class="hljs-string">"deberia retornar un medico cuando realice la consulta en la base de datos  en ese horario"</span>)
<span class="hljs-built_in">void</span> <span class="hljs-title function_">seleccionarMedicoConEspecialidadEnFechaEscenario2</span>(<span class="hljs-params"></span>) {

   <span class="hljs-comment">//given</span>
   <span class="hljs-keyword">var</span> proximoLunes10H = <span class="hljs-title class_">LocalDate</span>.<span class="hljs-title function_">now</span>()
           .<span class="hljs-title function_">with</span>(<span class="hljs-title class_">TemporalAdjusters</span>.<span class="hljs-title function_">next</span>(<span class="hljs-title class_">DayOfWeek</span>.<span class="hljs-property">MONDAY</span>))
           .<span class="hljs-title function_">atTime</span>(<span class="hljs-number">10</span>,<span class="hljs-number">0</span>);

   <span class="hljs-keyword">var</span> medico=<span class="hljs-title function_">registrarMedico</span>(<span class="hljs-string">"Jose"</span>,<span class="hljs-string">"j@mail.com"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-title class_">Especialidad</span>.<span class="hljs-property">CARDIOLOGIA</span>);

   <span class="hljs-comment">//when</span>
   <span class="hljs-keyword">var</span> medicoLibre = medicoRepository.<span class="hljs-title function_">seleccionarMedicoConEspecialidadEnFecha</span>(<span class="hljs-title class_">Especialidad</span>.<span class="hljs-property">CARDIOLOGIA</span>,proximoLunes10H);

   <span class="hljs-comment">//then</span>
   <span class="hljs-title function_">assertThat</span>(medicoLibre).<span class="hljs-title function_">isEqualTo</span>(medico);
}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Recuerda que ya no estamos trabajando con un Repository, as铆 que no vamos a utilizar la anotaci贸n @DataJpaTest, sino la anotaci贸n @SpringBootTest en la clase. Esta anotaci贸n se utiliza cuando queremos levantar el contexto completo de Spring para simular nuestra clase Controller.</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assertions.*;

<span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsultaControllerTest</span> {

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Ahora, el esquema es el mismo que antes: queremos probar el m茅todo agendar(), as铆 que comenzaremos creando un m茅todo de prueba: void agendarEscenario1(). Encima del m茅todo, colocamos la anotaci贸n @Test seguida de la anotaci贸n @DisplayName para describir mejor el escenario de prueba.</p>
<p>Nuestra API est谩 usando Bean Validation, as铆 que si llega una solicitud con datos inv谩lidos, debe devolver el c贸digo 400. Queremos que este sea nuestro escenario de prueba, as铆 que lo definimos en la anotaci贸n @DisplayName:</p>
<p>Hay varios escenarios de prueba posibles; lo que incluimos en el c贸digo a continuaci贸n ser谩 el primero de ellos.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-comment">// Trecho de c贸digo suprimido</span>

<span class="hljs-variable">@SpringBootTest</span>
class ConsultaControllerTest {

    <span class="hljs-variable">@Test</span>
    <span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"deberia retornar estado http 400 cuando los datos ingresados sean invalidos"</span>)
    void <span class="hljs-built_in">agendarEscenario1</span>() {

    }

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Para poder simular una solicitud HTTP en el Controller cuando no hay una solicitud real, se utiliza la clase de Spring llamada MockMvc. Para hacer esto, declaramos un atributo llamado "mvc" y le a帽adimos la anotaci贸n "@Autowired". La clase MockMvc simula solicitudes HTTP utilizando el patr贸n MVC.</p>
<p>Para poder inyectar MockMvc en la clase ConsultaControllerTest, adem谩s de la anotaci贸n "@SpringBootTest" en la clase, necesitamos la anotaci贸n "@AutoConfigureMockMvc".</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-comment">// Trecho de c贸digo suprimido</span>

<span class="hljs-variable">@SpringBootTest</span>
<span class="hljs-variable">@AutoConfigureMockMvc</span>
class ConsultaControllerTest {

    <span class="hljs-variable">@Autowired</span>
    private MockMvc mvc;

    <span class="hljs-variable">@Test</span>
    <span class="hljs-variable">@DisplayName</span>(<span class="hljs-string">"deberia retornar estado http 400 cuando los datos ingresados sean invalidos"</span>)
    void <span class="hljs-built_in">agendarEscenario1</span>() {

    }

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Ahora, vamos a disparar la solicitud: simplemente utilizamos MockMvc y declaramos el m茅todo perform(). Este m茅todo realizar谩 una solicitud a nuestra API.</p>
<p>Entre los par茅ntesis, tendremos varios m茅todos est谩ticos, como GET, POST, PUT, DELETE. Uno de los m茅todos que queremos llamar desde nuestro Controlador es agendar(), un m茅todo POST (@PostMapping). Entonces, llamamos al m茅todo est谩tico POST en perform(), abrimos y cerramos par茅ntesis.</p>
<p>A continuaci贸n, queremos el retorno, ya que necesitamos guardar lo que se devolver谩. Para ello, llamamos al m茅todo .andReturn() para obtener el retorno, seguido del m茅todo .getResponse(). Lo guardaremos en una variable llamada response.</p>
<p>La idea es llamar a response, porque necesitamos guardarlo en alg煤n lugar.</p>
<p>Sin embargo, hubo un error de compilaci贸n. Al posicionar el cursor sobre el m茅todo perform(), vemos la advertencia de que hay una excepci贸n no tratada.</p>
<p>Este m茅todo puede lanzar una excepci贸n; como no queremos hacer su tratamiento, colocamos un throws en la firma del m茅todo. Con el cursor posicionado sobre perform(), pulsamos "Alt + Enter"; se sugerir谩 como primera opci贸n "Agregar excepci贸n a la firma del m茅todo".</p>
<pre class="prettyprint"><code class="hljs language-java">
<span class="hljs-comment">// Trecho de c贸digo suprimido</span>

    <span class="hljs-meta">@Test</span>
 <span class="hljs-meta">@DisplayName("deberia retornar estado http 400 cuando los datos ingresados sean invalidos")</span>

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">agendarEscenario1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception
{
       <span class="hljs-type">var</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> mvc.perform(post(urlTemplate:<span class="hljs-string">"/consultas"</span>))
            .andReturn().getResponse();

    }

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Ahora haremos la afirmaci贸n: vamos a verificar si el c贸digo de estado es 400, porque dispararemos la solicitud pero no llevamos ning煤n cuerpo en ella.</p>
<p>La solicitud no tiene ning煤n par谩metro, pero recuerde que, en la solicitud de programar una cita, el m茅dico es opcional, mientras que el paciente y la fecha son obligatorios.</p>
<p>Como no estamos proporcionando ni la ID ni la fecha, deber铆a devolver "error 400". Primero haremos las aserciones para eso.</p>
<p>Despu茅s de disparar la solicitud, declararemos el m茅todo assertThat() e importaremos el est谩tico de la misma manera que hicimos anteriormente, con el atajo "Alt + Enter". En este caso, seleccionamos la pen煤ltima opci贸n Assertions.assertThat, que proviene del paquete org.assertj.core.api.</p>
<p>Entre par茅ntesis, colocaremos response.getStatus() seguido de isEqualTo(), donde pasaremos 400. Para hacer esto, usaremos la clase de utilidad de Spring HttpStatus, del paquete org.springframework.http. Despu茅s de eso, agregamos la constante BAD_REQUEST seguida del m茅todo value().</p>
<pre class="prettyprint"><code class="hljs language-php">{
       <span class="hljs-keyword">var</span> response = mvc.<span class="hljs-title function_ invoke__">perform</span>(<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-attr">urlTemplate</span>:<span class="hljs-string">"/consultas"</span>))
            .<span class="hljs-title function_ invoke__">andReturn</span>().<span class="hljs-title function_ invoke__">getResponse</span>();
<span class="hljs-comment">//then</span>
<span class="hljs-title function_ invoke__">assertThat</span>(response.<span class="hljs-title function_ invoke__">getStatus</span>()).<span class="hljs-title function_ invoke__">isEqualTo</span>(HttpStatus.BAD_REQUEST.<span class="hljs-title function_ invoke__">value</span>());

    }</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>De esta forma, ser谩 devuelto el c贸digo 400.</p>
<p>El bloque de c贸digo anterior es el m茅todo utilizado para probar el c贸digo 400: primero, se dispara una solicitud a la direcci贸n "/consultas" mediante el m茅todo POST, sin llevar ning煤n cuerpo; a continuaci贸n, guardamos el resultado (.andReturn()) y el getResponse() en una variable y verificamos si el estado de la respuesta es 400, ya que en este escenario, este es el error que debe ocurrir.</p>
<p>Una vez finalizada nuestra prueba, podemos ejecutarla haciendo clic con el bot贸n derecho en la clase ConsultaControllerTest y seleccionando la opci贸n "Ejecutar". Observe que Spring levanta el servidor, pero no se dispara una solicitud real, sino una simulada.</p>
<p>En este caso, mi prueba fall贸: tenemos la informaci贸n de que se esperaba el error 400, pero se devolvi贸 el error 403.</p>
<pre class="prettyprint"><code class="hljs language-yaml"><span class="hljs-attr">org.opentest4j.AssertionFailedError:</span>
<span class="hljs-attr">expected:</span> <span class="hljs-number">400</span>
 <span class="hljs-attr">but was:</span> <span class="hljs-number">403</span>
<span class="hljs-string">Expected</span> <span class="hljs-string">:400</span>
<span class="hljs-string">Actual</span>   <span class="hljs-string">:403</span></code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Esto sucede debido a Spring Security. Para hacer una reserva a trav茅s de la URL, necesitamos estar conectados y no lo hemos hecho en esta prueba.</p>
<p>Se puede argumentar lo siguiente: en esta prueba, no estamos probando seguridad, autenticaci贸n y autorizaci贸n. Dicho esto, consideraremos que se ha iniciado sesi贸n para probar la llamada a la API independientemente de si estamos o no conectados.</p>
<p>驴C贸mo informar a Spring que se debe ignorar la autenticaci贸n?</p>
<p>Encima del m茅todo, adem谩s de las anotaciones @Test y @DisplayName, pondremos una tercera anotaci贸n de Spring: @WithMockUser.</p>
<pre class="prettyprint"><code class="hljs language-java"> <span class="hljs-meta">@Test</span>
 <span class="hljs-meta">@DisplayName("deberia retornar estado http 400 cuando los datos ingresados sean invalidos")</span>
<span class="hljs-meta">@WithMockUser</span>

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">agendarEscenario1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception
{
       <span class="hljs-type">var</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> mvc.perform(post(<span class="hljs-string">"/consultas"</span>))
            .andReturn().getResponse();
<span class="hljs-comment">//then</span>
assertThat(response.getStatus()).isEqualTo(HttpStatus.BAD_REQUEST.value());

    }

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Esta anotaci贸n sirve para indicarle a Spring que debe hacer una simulaci贸n de un usuario, considerando que estamos logueados al ejecutar el test, para hacer una llamada con autenticaci贸n. Si queremos llamar un m茅todo con autenticaci贸n, pero sin pasar el usuario, y hacer una prueba de seguridad, usamos esta anotaci贸n para que Spring simule el inicio de sesi贸n. Despu茅s de hacer esto, guardamos y volvemos a ejecutar el test, y se devolver谩 el error 400.</p>
<hr>
<p>En ConsultaControllerTest.java, donde ya tenemos el primer escenario @Test, simplemente tendremos que copiar y pegar para realizar las modificaciones de los siguientes escenarios.</p>
<p>Primero, renombraremos el m茅todo de programaci贸n para agendarEscenario2() y el contenido de @DisplayName() a "Deber铆a devolver el c贸digo http 200 cuando la informaci贸n es v谩lida".</p>
<p>El assetThat() con response.getStatus() ya no ser谩 BAD_REQUEST, sino OK para devolver el c贸digo 200. Sin embargo, en este m茅todo necesitaremos enviar un JSON v谩lido.</p>
<p>Para esto, el .perform() recibir谩 post() en el que pasaremos .content() para enviar el JSON. Podr铆amos escribirlo manualmente como una cadena, pero esto no es recomendable porque es muy trabajoso, o podr铆amos usar una clase de Spring para hacer la creaci贸n del JSON m谩s f谩cil.</p>
<p>Antes de eso, tendremos que llamar a .contentType() para enviar la cabecera HTTP que indica que se est谩n enviando datos en formato JSON. Esto se hac铆a autom谩ticamente en Postman, pero aqu铆 tendremos que hacerlo manualmente. Dentro de los par谩metros, pasaremos como par谩metro la clase MediaType de Spring que proviene del paquete org.springframework.http, seguida de .APPLICATION_JSON.</p>
<p>Inyectamos otra clase de utilidad adem谩s de MockMvc llamada private JacksonTester&lt;&gt; que tiene gen茅ricos con el tipo de objeto con el que trabajar谩. En nuestro caso, deber谩 ser del mismo tipo DatosAgendarConsulta recibido en el m茅todo agendar() del ConsultaController.</p>
<p>Copiaremos esta clase y la a帽adiremos dentro de los gen茅ricos de JacksonTester&lt;&gt;. Luego, llamaremos al atributo DatosAgendarConsulta.</p>
<p>Duplicaremos este atributo porque necesitaremos dos JSONs, el que llega a la API y el que se devuelve por ella. En este 煤ltimo, lo que llegar谩 ser谩 el gen茅rico DatosDetalleConsulta y el atributo ser谩 DatosDetalleConsulta.</p>
<pre class="prettyprint"><code class="hljs language-swift"><span class="hljs-comment">//trecho de c贸digo suprimido</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsultaControllerTest</span> {

 <span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">MockMvc</span> mvc;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">JacksonTester</span>&lt;<span class="hljs-type">DatosAgendarConsulta</span>&gt; agendarConsultaJacksonTester;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">JacksonTester</span>&lt;<span class="hljs-type">DatosDetalleConsulta</span>&gt; detalleConsultaJacksonTester;

<span class="hljs-comment">//trecho de c贸digo suprimido</span>

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>En el archivo ConsultaController.java, podemos observar que el m茅todo agendar() recibe DatosAgendarConsulta pero devuelve otro dato, que es DatosDetalleConsulta. Por lo tanto, en nuestro test, debemos tener dos JacksonTester&lt;&gt; para simular el JSON de entrada y salida que se devuelve.</p>
<p>Volviendo a nuestro test, dentro de .content(), pasaremos DatosAgendarConsulta con .write() recibiendo el objeto new DatosAgendarConsulta, donde pasaremos la identificaci贸n de un m茅dico y un paciente, como 2l y 5l por ejemplo. Tambi茅n necesitaremos pasar una fecha y la especialidad. Lo guardaremos en variables antes de response, donde var fecha ser谩 igual a LocalDateTime.now(). La fecha puede ser actual porque estamos llamando al controller directamente, por lo que no haremos validaci贸n, simplemente cambiaremos la hora con .plusHours(1) para agregar una hora m谩s, dejando claro que es una fecha en el futuro. En una nueva l铆nea siguiente, crearemos la var especialidad que ser谩 igual a Especialidad.CARDIOLOGIA, por ejemplo.</p>
<p>Al instanciar DatosAgendarConsulta, pasaremos los ids del m茅dico, del paciente, la fecha y la especialidad. Sin embargo, no podemos pasar .write() directamente a .content() porque devuelve otro tipo de objeto. Por lo tanto, justo despu茅s de su par茅ntesis de cierre, llamaremos a .getJson() para convertirlo en una cadena JSON.</p>
<p>El objeto JacksonTester&lt;&gt; toma lo que pasamos como par谩metro y lo convierte en JSON en formato de cadena sin necesidad de crearlo manualmente.</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-meta">@Test</span>
<span class="hljs-meta">@DisplayName("deberia retornar estado http 200 cuando los datos ingresados son validos")</span>
<span class="hljs-meta">@WithMockUser</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">agendarEscenario2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
   <span class="hljs-comment">//given</span>
   <span class="hljs-type">var</span> <span class="hljs-variable">fecha</span> <span class="hljs-operator">=</span> LocalDateTime.now().plusHours(<span class="hljs-number">1</span>);
   <span class="hljs-type">var</span> <span class="hljs-variable">especialidad</span> <span class="hljs-operator">=</span> Especialidad.CARDIOLOGIA;
   <span class="hljs-type">var</span> <span class="hljs-variable">datos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatosDetalleConsulta</span>(<span class="hljs-literal">null</span>,<span class="hljs-number">2l</span>,<span class="hljs-number">5l</span>,fecha);

   <span class="hljs-comment">// when</span>

   when(agendaDeConsultaService.agendar(any())).thenReturn(datos);

   <span class="hljs-type">var</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> mvc.perform(post(<span class="hljs-string">"/consultas"</span>)
           .contentType(MediaType.APPLICATION_JSON)
           .content(agendarConsultaJacksonTester.write(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DatosAgendarConsulta</span>(<span class="hljs-number">2l</span>,<span class="hljs-number">5l</span>,fecha, especialidad)).getJson())
   ).andReturn().getResponse();

   <span class="hljs-comment">//then</span>
   assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Ya hemos hecho la solicitud, llevando la cabecera contentType() y el JSON creado por JacksonTester&lt;&gt;.</p>
<p>En las afirmaciones assertThat(), solo estamos verificando si el c贸digo HTTP est谩 siendo devuelto como 200. Pero adem谩s de eso, deberemos verificar si el JSON que se est谩 devolviendo es el que esperamos.</p>
<p>Crearemos una variable jsonEsperado que ser谩 igual a DatosDetalleConsulta.Json con .write() recibiendo como par谩metro new DatosDetalleConsulta().</p>
<p>Esta clase recibir谩 un objeto del tipo Consulta o las identificaciones de la consulta, del m茅dico, del paciente y de la fecha.</p>
<p>El ID de la consulta, como no llamaremos a la base de datos, no recibiremos un identificador correcto, por lo que en principio lo pasaremos como nulo.</p>
<p>La identificaci贸n del m茅dico deber谩 ser 2l, del paciente 5l, seguida de la misma fecha. Despu茅s de crear el objeto, aplicaremos .getJson() para devolver un JSON.</p>
<p>En la l铆nea siguiente, llamaremos al assertThat() que contiene response.getContentAsString() para tener el contenido como cadena. Luego, aplicaremos isEqualTo(jsonEsperado).</p>
<pre class="prettyprint"><code class="hljs language-csharp"><span class="hljs-comment">//then</span>
assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.<span class="hljs-keyword">value</span>());

<span class="hljs-keyword">var</span> jsonEsperado = detalleConsultaJacksonTester.write(datos).getJson();

assertThat(response.getContentAsString()).isEqualTo(jsonEsperado);</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Ejecutaremos esta prueba y esperaremos a que termine la ejecuci贸n. Tendremos un error indicando que JacksonTester&lt;&gt; no fue encontrado, ya que para poder inyectarlo, es necesario tener otra anotaci贸n encima de la clase llamada @AutoConfigureJsonTesters.</p>
<pre class="prettyprint"><code class="hljs language-less"><span class="hljs-variable">@SpringBootTest</span>
<span class="hljs-variable">@AutoConfigureMockMvc</span>
<span class="hljs-variable">@AutoConfigureJsonTesters</span>
class ConsultaControllerTest {

<span class="hljs-comment">//trecho de c贸digo suprimido</span>

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Al ejecutar nuevamente, no habr谩 errores, pero la prueba fallar谩. Se realiz贸 la selecci贸n de la base de datos y se dispar贸 la consulta, pero eso no es lo que quer铆amos, ya que quer铆amos acceder solo al controlador de manera aislada, y por eso fall贸.</p>
<p>Falta indicarle a Spring que no use la base de datos real. En ConsultaController.java, veremos que se est谩 inyectando la clase AgendaDeConsultaService que est谩 accediendo a la base de datos.</p>
<p>Para solicitar un mock de este objeto, volvemos a la clase de prueba y declaramos otro atributo private AgendaDeConsultaService agendaDeConsultaService y, encima de 茅l, colocamos la anotaci贸n @MockBean.</p>
<p>Con esto, le decimos a Spring que cuando necesite inyectar este objeto en el controlador, debe aplicar el mock y no inyectar una agendaDeConsultaService real.</p>
<pre class="prettyprint"><code class="hljs language-swift"><span class="hljs-comment">//trecho de c贸digo suprimido</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsultaControllerTest</span> {

 <span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">MockMvc</span> mvc;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">JacksonTester</span>&lt;<span class="hljs-type">DatosAgendarConsulta</span>&gt; agendarConsultaJacksonTester;

<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">JacksonTester</span>&lt;<span class="hljs-type">DatosDetalleConsulta</span>&gt; detalleConsultaJacksonTester;

<span class="hljs-meta">@MockBean</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">AgendaDeConsultaService</span> agendaDeConsultaService;

<span class="hljs-comment">//trecho de c贸digo suprimido</span>

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre><p>Guardaremos y volveremos a ejecutar la prueba. Veremos que no se ejecut贸 la consulta ni se accedi贸 a la base de datos, pero la prueba fall贸 de nuevo. El retorno dice que el JSON devuelto deber铆a ser la identificaci贸n nula, la del m茅dico 2 y la del paciente 5, adem谩s de la fecha actual, pero lo que lleg贸 fue un JSON vac铆o "". Entonces, por alguna raz贸n, no devolvi贸 nada, es decir, recibi贸 el c贸digo 200 pero el cuerpo lleg贸 vac铆o.</p>
<p>Esto sucedi贸 porque, en nuestro controlador, llamamos a agendaDeConsultaService.agendar(), pero nuestra agenda es un mock, que por defecto devuelve nulo. Entonces, nuestro dto est谩 nulo, y al momento de hacer la conversi贸n, este dto devuelto por Spring es null.</p>
<p>Es un mock pero necesitaremos simular diciendo que, cuando el m茅todo agendar() sea llamado, devolveremos la informaci贸n proporcionada. Para hacer esta configuraci贸n, volveremos al archivo de prueba y, antes de disparar la solicitud de verdad, usaremos Mockito, que es la biblioteca de mocks que Spring usa .</p>
<p>Despu茅s de var especialidad y antes de var response, llamaremos al m茅todo when() y haremos la importaci贸n autom谩tica de la biblioteca. Entonces, cuando se llame a agendaDeConsultaService.agendar(), tendremos el thenReturn() para devolver el nuevo objeto DatosDetalleConsulta esperado.</p>
<p>M谩s adelante, en jsonEsperado, recortaremos la l铆nea de new DatosDetalleConsulta() y escribiremos datos, que se pasar谩 en el thenReturn(). A continuaci贸n, lo lanzaremos a una nueva variable llamada datosDetalleConsulta, que es igual a new DatosDetalleConsulta() con null, 2l, 5l, fecha.</p>
<p>En when(), el contenido de .thenReturn() ser谩 solo datos. Por lo tanto, cuando la agenda que es el mock tenga el m茅todo .agendar() llamado, no importar谩 el par谩metro para devolver los datos.</p>
<p>Con esto, dispararemos la solicitud y, finalmente, verificaremos si el JSON devuelto es igual al objeto esperado.</p>
<pre class="prettyprint"><code class="hljs language-java"><span class="hljs-meta">@Test</span>
<span class="hljs-meta">@DisplayName("deberia retornar estado http 200 cuando los datos ingresados son validos")</span>
<span class="hljs-meta">@WithMockUser</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">agendarEscenario2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
   <span class="hljs-comment">//given</span>
   <span class="hljs-type">var</span> <span class="hljs-variable">fecha</span> <span class="hljs-operator">=</span> LocalDateTime.now().plusHours(<span class="hljs-number">1</span>);
   <span class="hljs-type">var</span> <span class="hljs-variable">especialidad</span> <span class="hljs-operator">=</span> Especialidad.CARDIOLOGIA;
   <span class="hljs-type">var</span> <span class="hljs-variable">datos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatosDetalleConsulta</span>(<span class="hljs-literal">null</span>,<span class="hljs-number">2l</span>,<span class="hljs-number">5l</span>,fecha);

   <span class="hljs-comment">// when</span>

   when(agendaDeConsultaService.agendar(any())).thenReturn(datos);

   <span class="hljs-type">var</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> mvc.perform(post(<span class="hljs-string">"/consultas"</span>)
           .contentType(MediaType.APPLICATION_JSON)
           .content(agendarConsultaJacksonTester.write(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DatosAgendarConsulta</span>(<span class="hljs-number">2l</span>,<span class="hljs-number">5l</span>,fecha, especialidad)).getJson())
   ).andReturn().getResponse();

   <span class="hljs-comment">//then</span>
   assertThat(response.getStatus()).isEqualTo(HttpStatus.OK.value());

   <span class="hljs-type">var</span> <span class="hljs-variable">jsonEsperado</span> <span class="hljs-operator">=</span> detalleConsultaJacksonTester.write(datos).getJson();

   assertThat(response.getContentAsString()).isEqualTo(jsonEsperado);

}</code><button type="button" class="clipit">Copia el c贸digo</button></pre>
		</div>
		<div class="task-actions">
			






    
        
        <a href="https://app.aluracursos.com/forum/curso-spring-boot-3-api-para-su-implementacion/exercicio-haga-lo-que-hicimos-en-aula/84616/novo" class=" task-actions-button task-actions-button-forum bootcamp-secondary-button-theme" target="_blank">
            
                
                
                    Discutir en el Foro
                
            
        </a>
    



			
				
					<button class="task-actions-button task-actions-button-answer task-body-actions-button task-actions-button-showOpinion bootcamp-primary-button-theme">Ver opini贸n del instructor</button>
				
				
			
		</div>
		
			





<section id="task-feedback" class="task-feedback" aria-hidden="true">
	<section class="task-feedback-banner">
		<div class="container">
			<h3 class="task-feedback-banner-title">
				Opini贸n del instructor
			</h3>
		</div>
		







<div class="video settings">
	<button type="button" class="settings-button" aria-label="Configuraciones">
		<svg class="settings-button-icon">
			<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MENU_SETTINGS"></use>
		</svg>
	</button>
	<div class="settings-box">
		<ul class="settings-box-list">
			
				<li class="settings-box-item settings-box-item-darkmode">
					<button class="dark-mode-action">
						Modo nocturno
					</button>
				</li>
			
			
				
				
				
				
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://app.aluracursos.com/suggestions/new/spring-boot-3-api-para-su-implementacion/84616/opinion">Sugerir alteraci贸n</a></li>
					
				
			
			
		</ul>
		<span class="settings-box-title"></span>
	</div>
</div>

	</section>
	
				<div class="formattedText" data-external-links="">
					<p>Contin煤e con sus estudios, y si tiene alguna pregunta, 隆no dude en usar nuestro foro!</p>
				</div>
			
</section>
		
	</div>
</section>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

				
					






	
	
		<section class="task-actions">
			<div class="container">
				






    
        
        <a href="https://app.aluracursos.com/forum/curso-spring-boot-3-api-para-su-implementacion/exercicio-haga-lo-que-hicimos-en-aula/84616/novo" class=" task-actions-button task-actions-button-forum bootcamp-secondary-button-theme" target="_blank">
            
                
                
                    Discutir en el Foro
                
            
        </a>
    



				
				
				
				
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84616/next" style="background-color: #2A7AE4" class="task-actions-button task-body-actions-button task-actions-button-next bootcamp-next-button bootcamp-primary-button-theme">Pr贸xima Actividad</a>
				
			</div>
		</section>
	


				
				
			</main>
		</div>
	</section>
	

















<button title="Abrir menu" aria-label="Abrir menu" type="button" class="openMenu-button task-body-button openMenu-button--inactive">
</button>

<aside class="task-menu task-menu-iframe" style="position: fixed; transform: translateY(0px);">
	<section class="task-menu-header">
		<button title="Abrir menu" aria-label="Abrir menu" type="button" class="openMenu-button task-menu-button openMenu-button--inactive"></button>
		<div class="task-menu-header-info">
			<a class="task-menu-header-info-title" href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion" title="Ir para la p谩gina del curso">
				
					
					
						<img src="./haga_lo_que_hicimos_files/spring-boot-3-api-para-su-implementacion.svg" alt="铆cone Spring Boot 3: documentar, probar y preparar una API para su implementaci贸n" class="task-menu-header-info-title-icon " width="37.5px" height="37.5px">
					
				
				<h2 class="task-menu-header-info-title-text">Spring Boot 3: documentar, probar y preparar una API para su implementaci贸n</h2>
			</a>
			
				<div class="task-menu-header-info-progress">
					
					<span class="task-menu-header-info-progress-percentage ">78%</span>
					
						
						
						
							
						
					
					<span class="task-menu-header-info-progress-bar" style="background-image: linear-gradient(to right, #9de482, #9de482 78%, transparent 78%);"></span>
				</div>
			

		</div>
	</section>
	
		<form class="task-menu-header-search" target="_blank" action="https://app.aluracursos.com/search/course/spring-boot-3-api-para-su-implementacion" method="get">
			<label class="task-menu-header-search-title" for="query">Buscar en este curso</label>
			<input class="task-menu-header-search-input" name="query" id="query" type="text" required="">
			<button class="task-menu-header-search-button">Buscar <img aria-hidden="true" class="task-menu-header-search-button-img" src="./haga_lo_que_hicimos_files/icon-new-page.svg"></button>
		</form>
	
	
	<section class="task-menu-section sr-only">
		<div class="task-menu-section-title">
			<span class="task-menu-section-title-number ">Aula<strong>04</strong>
				<span>de 05</span>
			</span>
			<h3 class="task-menu-section-title-text">
				Tests automatizados
			</h3>
		</div>
	</section>
	<section class="task-menu-sections">
		<h2 class="task-menu-sections-title">
			Clase actual
		</h2>
		<select class="task-menu-sections-select" onchange="location.href=&#39;/course/spring-boot-3-api-para-su-implementacion/section/&#39;+this.value+&#39;/tasks&#39;;">
			
				<option value="11458">01. Agendamiento de consultas</option>
			
				<option value="11459">02. Reglas de negocio</option>
			
				<option value="11460">03. Documentaci贸n de la API</option>
			
				<option value="11461" selected="">04. Tests automatizados</option>
			
				<option value="11462">05. Build del proyecto</option>
			
		</select>
	</section>
	<nav class="task-menu-nav">
		<h2 class="task-menu-nav-title">
			Actividades
			<span>9 de 10</span>
		</h2>
		<ul class="task-menu-nav-list">
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84633" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicaci贸n completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#HQ_EXPLANATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">01</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Proyecto del aula anterior">
							Proyecto del aula anterior
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84354" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">02</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Testes con Spring Boot">
							Testes con Spring Boot
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el V铆deo">05min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84355" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">03</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Configurando el banco de datos de test">
							Configurando el banco de datos de test
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el V铆deo">19min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84626" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Explicaci贸n completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#COMPLEMENTARY_INFORMATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">04</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Para saber m谩s: pruebas con in-memory database">
							Para saber m谩s: pruebas con in-memory database
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84356" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">05</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Testando el repository">
							Testando el repository
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el V铆deo">15min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84357" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">06</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Testando Error 400">
							Testando Error 400
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el V铆deo">14min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84358" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Video completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">07</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Testando Response 200">
							Testando Response 200
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para el V铆deo">17min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84589" class="task-menu-nav-item-link task-menu-nav-item-link-MULTIPLE_CHOICE">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Opci贸n m煤ltiple completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#MULTIPLE_CHOICE"></use>
					</svg>
					<span class="task-menu-nav-item-number">08</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="C贸digos testables">
							C贸digos testables
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item task-menu-nav-item--selected">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84616" class="task-menu-nav-item-link task-menu-nav-item-link-TEXT_CONTENT">
						
						
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Actividad de Sin respuesta del estudiante completada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#DO_AFTER_ME"></use>
					</svg>
					<span class="task-menu-nav-item-number">09</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Haga lo que hicimos en aula">
							Haga lo que hicimos en aula
						</span>
						
					</span></a>
				</li>
			
				
				<li class="task-menu-nav-item ">
					<a href="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84639" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
						
						
					<svg class="task-menu-nav-item-svg " aria-label="Actividad de Explicaci贸n inacabada">
						<use xlink:href="/assets/images/classPage/icon-menu-icons.svg#WHAT_WE_LEARNED"></use>
					</svg>
					<span class="task-menu-nav-item-number">10</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Lo que aprendimos">
							Lo que aprendimos
						</span>
						
					</span></a>
				</li>
			
			
		</ul>
	</nav>
	<section class="task-menu-others">
		<h2 class="task-menu-others-title ">
			Otros Links
		</h2>
		
			<a class="task-menu-others-link task-menu-others-link-discord" href="https://discord.com/invite/bts3Yzb9uk" target="_blank">
				Discord Alura
			</a>
		
		
			
			<a href="https://app.aluracursos.com/forum/curso-spring-boot-3-api-para-su-implementacion/todos" class="task-menu-others-link task-menu-others-link-forum" title="Ir para el foro do curso" target="_blank">
				
					
					
					
						Foro del curso
					
				
			</a>
		
		<a href="https://app.aluracursos.com/dashboard" class="task-menu-others-link task-menu-others-link-curso" title="Ir para la p谩gina principal">Volver al Dashboard</a>
		
		<section class="task-container-flex --task-button-column">
			
				<div class="task-group-border --task-closed-border">
					<button class="task-edit-mode settings-box-item-darkmode">Modo nocturno</button>
				</div>
			
		</section>
	</section>
	<section class="task-menu-footer">
		<a class="task-menu-footer-user" href="https://app.aluracursos.com/user/sboboda1997" title="Ir para su p谩gina de usuario">
			<img src="./haga_lo_que_hicimos_files/k-kurt.png" alt="Gravatar de Kevin Sboboda" class="task-menu-footer-img" width="40px" height="40px">
			
				<p class="task-menu-footer-detalhes">
					<span class="task-menu-footer-detalhes-nome">Kevin Sboboda</span>
					<span class="task-menu-footer-detalhes-xp">
						77.6k xp
					</span>
				</p>
			
			<input type="hidden" value="">
			<input type="hidden" value="">
		</a>
		<a href="https://app.aluracursos.com/dashboard" class="task-menu-footer-logo">
			<img src="./haga_lo_que_hicimos_files/icon-menu-alura_espanhol.svg" alt="Logo da Alura Latam" class="task-menu-footer-logo-image" width="19px" height="32px" title="Ir para la p谩gina principal">
		</a>
	</section>
</aside>




    

</section><div class="full-screen__panel" style="display: none;">
				<img id="full-screen__image" class="full-screen__image" src="https://app.aluracursos.com/course/spring-boot-3-api-para-su-implementacion/task/84616" alt="">
				<div class="full-screen__actions">
				<button class="button buttonAction partitura-download">Anterior</button><button class="button buttonAction partitura-download">Sair</button><button class="button buttonAction partitura-download">Pr贸ximo</button></div> 
			</div>










	

	<script src="./haga_lo_que_hicimos_files/jquery-3.6.0.min.7c14a783.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/buttonToggle.41524be9.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/sectionMenu.2bb600e2.js.descarga" async=""></script>
	<script src="./haga_lo_que_hicimos_files/submitTaskVerifier.e6e3bd5f.js.descarga"></script>

    <script src="./haga_lo_que_hicimos_files/purify.min.bd253e08.js.descarga"></script>

	<script src="./haga_lo_que_hicimos_files/caret.2e5c0c9d.js.descarga" async=""></script>
	<script src="./haga_lo_que_hicimos_files/keydownWatchers.fdc4ec79.js.descarga" async=""></script>

	<script src="./haga_lo_que_hicimos_files/highlight.min.9b99da81.js.descarga" async=""></script>
	<script src="./haga_lo_que_hicimos_files/highlight.init.5870d8cf.js.descarga" async=""></script>

	<script src="./haga_lo_que_hicimos_files/preventsMultipleInteractions.19502e19.js.descarga" async=""></script>
	<script src="./haga_lo_que_hicimos_files/assessment.78d1fb98.js.descarga" async=""></script>

	<script src="./haga_lo_que_hicimos_files/menuSettings.fb011b3b.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/aria.a82b16ad.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/ProjectSubmit.1e34b47f.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/LinkSubmit.60d53572.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/classPage.fcad576a.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/phrase.dfd04ee1.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/feedback.7962df4a.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/ExtraContentProgressRequest.aec577c3.js.descarga"></script>
	
	

	
	
	
	
	

	<script src="./haga_lo_que_hicimos_files/partitura.3e404a17.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/audioProgress.049144a0.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/audioPlayer.38483a63.js.descarga"></script>

		
	<script src="./haga_lo_que_hicimos_files/VideoTranscription.60f380a7.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/MarkdownProcessing.2cb5d893.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/clipboard.min.af8ab365.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/Clipper.5c96d26f.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/scroll-to-top.373e0d1c.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/shortcuts-action.eba8a7c6.js.descarga"></script>
	<script src="./haga_lo_que_hicimos_files/ModalAndAlertHandler.9c67ae4b.js.descarga"></script>
    


	<script>
		new VideoTranscription();
		new MarkdownProcessing("https://app.aluracursos.com").onLoad();
		new Clipper("Copia el c贸digo", "C贸digo copiado", "No se pudo copiar el c贸digo");
		window.addEventListener('load', () => new BackToTopButton().init());
		new ModalAndAlertHandler('spring-boot-3-api-para-su-implementacion').setupListeners();
	</script>



	

	<script src="./haga_lo_que_hicimos_files/darkMode.b7bc2dd7.js.descarga"></script>

	
		




<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-42101548-21', 'aluracursos.com');

    
        ga('set', 'userId', '576082');
    

    ga('require', 'displayfeatures');
    
    ga('send', 'pageview');
    
    
</script>
	

	<script>new DarkModeToggler().refreshListener()</script>
    



































<link href="./haga_lo_que_hicimos_files/uploadImages.7c1a29db.css" rel="stylesheet">

<script src="./haga_lo_que_hicimos_files/UploadProgress.098aba94.js.descarga"></script>
<script src="./haga_lo_que_hicimos_files/ImagesClient.f10726e3.js.descarga"></script>

<script src="./haga_lo_que_hicimos_files/marked.min.c69e14e8.js.descarga"></script>

<script src="./haga_lo_que_hicimos_files/enableForumButtons.1293253c.js.descarga"></script>

<script>
    var IMAGE_UPLOAD_MESSAGES = {
        imageUploadMessageInit: `Adjunte archivos arrastr谩ndolos y solt谩ndolos`,
        imageUploadMessageDragEnter: `Suelta la imagen para subir`,
        imageUploadMessageDrop: `Subiendo la imagen #images_names#`,
        imageUploadMessageProgress: `Subiendo la imagen #images_names#: #progress#%`,
        imageUploadMessageUploaded: `隆Imagen enviada con 茅xito!`,
        imageUploadMessageSizeUnits: `MB`,
        imageUploadMessageTag: `![Ingrese aqu铆 la descripci贸n de esta imagen para ayudar con la accesibilidad](#url#) `
    }
</script>


    
        <link href="./haga_lo_que_hicimos_files/hackeditor.min.fcf421a7.css" rel="stylesheet">
        <link href="./haga_lo_que_hicimos_files/hackeditor.custom.e0057fb6.css" rel="stylesheet">
        <link href="./haga_lo_que_hicimos_files/github.754087c4.css" rel="stylesheet">

        <script src="./haga_lo_que_hicimos_files/hackeditor.min.4c55d65b.js.descarga"></script>
        <script src="./haga_lo_que_hicimos_files/hackeditor.custom.b88c034d.js.descarga"></script>
        <script src="./haga_lo_que_hicimos_files/highlight.min.9b99da81.js.descarga"></script>
        <script>
            const setupEditorsOnPage = (e) => {
                const toolbarActionsHints = {
                    toggleHeadingActionHint: `Encabezado`,
                    toggleBoldActionHint: `Negrito`,
                    toggleItalicActionHint: `Cursiva`,
                    toggleOrderedListActionHint: `Lista ordenada`,
                    toggleUnorderedListActionHint: `Lista desordenada`,
                    togglePreviewActionHint: `Alternar vista previa`,
                    drawTableActionHint: `Insertar tabla`,
                    drawCodeActionHint: `Insertar bloque de c贸digo`,
                    drawLinkActionHint: `Insertar enlace`,
                    drawImageActionHint: `Insertar imagen`,
                    drawUploadedImageActionHint: `Carga de imagen`,
                    undoActionHint: `Deshacer`,
                    redoActionHint: `Rehacer`
                }

                const imageUploadErrors = {
                    imageErrorLimit: `隆Solo puede insertar 5 im谩genes a la vez!`,
                    imageFileNotAllowed: `El archivo filename no est谩 permitido, 隆solo im谩genes!`,
                    imageVeryLarge: `El archivo filename supera el l铆mite de 2 MB.`,
                    imageMaliciousFile: `El archivo filename contiene contenido malicioso.`
                }

                window.editors = window.editors || [];

                const editorsElements = window.editors.map(ed => ed.element.id);

                const textAreaEditors = Array.from(document.querySelectorAll('.hackeditor > textarea'));
                textAreaEditors
                    .filter(e => e.closest('.taskForms') == null)
                    .filter(e => editorsElements.length == 0 ? true : !editorsElements.includes(e.id))
                    .forEach(editorTextArea => {
                        const editor = setupHackEditor({
                            editorOptions: {
                                element: editorTextArea,
                                initialValue: editorTextArea.innerText,
                                syncPreview: true,
                                maxHeight: "300px",
                                toolbarActionsHints,
                                imageUploadMessages: IMAGE_UPLOAD_MESSAGES,
                                imageUploadErrors,
                                imageUploadClient: new ImagesClient(
                                    'https://www.gnarususercontent.com.br/images',
                                    'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2MTc4MDcxMzMsImtleSI6IjRiYWRlNDg1LTFjYjYtNDYzNy1iMTRlLWIxYTY2MzRhZDYyNyJ9.VHSsMMu_Qmm9G5HbJD9jA86B2hddM07XRbObvZRh0Ns',
                                    6,
                                    576082
                                ),
                                allowImageUpload: editorTextArea.dataset.allowImageUpload
                            },
                            extensions: {
                                DOMPurify,
                                marked,
                                hljs
                            }
                        });

                        window.editors.push({
                            instance: editor,
                            element: editorTextArea,
                        });

                        enableForumButtons();
                });
            }

            window.addEventListener('DOMContentLoaded', setupEditorsOnPage);
            document.addEventListener('change', setupEditorsOnPage);
        </script>
    
    

<script src="./haga_lo_que_hicimos_files/IframeChecker.05103d26.js.descarga"></script>



<button class="back-to-top" type="button" style="display: none;"><span class="back-to-top__text">Voltar ao topo</span></button></body></html>